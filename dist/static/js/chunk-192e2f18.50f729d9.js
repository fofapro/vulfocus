(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-192e2f18"],{"02f4":function(e,t,a){var i=a("4588"),n=a("be13");e.exports=function(e){return function(t,a){var l,r,s=String(n(t)),o=i(a),c=s.length;return o<0||o>=c?e?"":void 0:(l=s.charCodeAt(o),l<55296||l>56319||o+1===c||(r=s.charCodeAt(o+1))<56320||r>57343?e?s.charAt(o):l:e?s.slice(o,o+2):r-56320+(l-55296<<10)+65536)}}},"0390":function(e,t,a){"use strict";var i=a("02f4")(!0);e.exports=function(e,t,a){return t+(a?i(e,t).length:1)}},"214f":function(e,t,a){"use strict";a("b0c5");var i=a("2aba"),n=a("32e9"),l=a("79e5"),r=a("be13"),s=a("2b4c"),o=a("520a"),c=s("species"),u=!l((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();e.exports=function(e,t,a){var f=s(e),p=!l((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),m=p?!l((function(){var t=!1,a=/a/;return a.exec=function(){return t=!0,null},"split"===e&&(a.constructor={},a.constructor[c]=function(){return a}),a[f](""),!t})):void 0;if(!p||!m||"replace"===e&&!u||"split"===e&&!d){var g=/./[f],v=a(r,f,""[e],(function(e,t,a,i,n){return t.exec===o?p&&!n?{done:!0,value:g.call(t,a,i)}:{done:!0,value:e.call(a,t,i)}:{done:!1}})),h=v[0],b=v[1];i(String.prototype,e,h),n(RegExp.prototype,f,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},3007:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"f",(function(){return c}));var i=a("b775");function n(e,t,a,n,l,r){void 0===e&&(e=""),void 0!==r&&null!=r||(r=0),void 0!==l&&null!=l||(l=""),void 0!==a&&null!=a||(a=1);var s="/images/?query="+e+"&page="+a+"&rank="+r+"&type="+l,o="";!0===t&&(o="flag",s+="&flag="+o);var c="";return!0===n&&(c="temp",s+="&temp="+c),Object(i["a"])({url:s,method:"get"})}function l(e){return Object(i["a"])({url:"/images/"+e+"/start/",method:"get"})}function r(e){return(void 0===e||null===e||e<1)&&(e=1),Object(i["a"])({url:"/container/?page="+e,method:"get"})}function s(e){return Object(i["a"])({url:"/container/"+e+"/delete/",method:"delete"})}function o(e){return Object(i["a"])({url:"/container/"+e+"/stop/",method:"get"})}function c(e,t){return Object(i["a"])({url:"/container/"+e+"/flag/?flag="+t,method:"get"})}},"386d":function(e,t,a){"use strict";var i=a("cb7c"),n=a("83a1"),l=a("5f1b");a("214f")("search",1,(function(e,t,a,r){return[function(a){var i=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,i):new RegExp(a)[t](String(i))},function(e){var t=r(a,e,this);if(t.done)return t.value;var s=i(e),o=String(this),c=s.lastIndex;n(c,0)||(s.lastIndex=0);var u=l(s,o);return n(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},"4dd0":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s}));var i=a("b775");function n(e,t,a){return void 0!==t&&null!==t||(t=1),void 0!==a&&null!=a||(a=""),Object(i["a"])({url:"/container/?flag="+e+"&page="+t+"&image_id="+a,method:"get"})}function l(e){return Object(i["a"])({url:"/container/"+e+"/stop/?flag=list",method:"get"})}function r(e){return Object(i["a"])({url:"/container/"+e+"/start/?flag=list",method:"get"})}function s(e){return Object(i["a"])({url:"/container/"+e+"/delete/?flag=list",method:"delete"})}},"520a":function(e,t,a){"use strict";var i=a("0bfb"),n=RegExp.prototype.exec,l=String.prototype.replace,r=n,s="lastIndex",o=function(){var e=/a/,t=/b*/g;return n.call(e,"a"),n.call(t,"a"),0!==e[s]||0!==t[s]}(),c=void 0!==/()??/.exec("")[1],u=o||c;u&&(r=function(e){var t,a,r,u,d=this;return c&&(a=new RegExp("^"+d.source+"$(?!\\s)",i.call(d))),o&&(t=d[s]),r=n.call(d,e),o&&r&&(d[s]=d.global?r.index+r[0].length:t),c&&r&&r.length>1&&l.call(r[0],a,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(r[u]=void 0)})),r}),e.exports=r},"5f1b":function(e,t,a){"use strict";var i=a("23c6"),n=RegExp.prototype.exec;e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var l=a.call(e,t);if("object"!==typeof l)throw new TypeError("RegExp exec method returned something other than an Object or null");return l}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},a481:function(e,t,a){"use strict";var i=a("cb7c"),n=a("4bf8"),l=a("9def"),r=a("4588"),s=a("0390"),o=a("5f1b"),c=Math.max,u=Math.min,d=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};a("214f")("replace",2,(function(e,t,a,g){return[function(i,n){var l=e(this),r=void 0==i?void 0:i[t];return void 0!==r?r.call(i,l,n):a.call(String(l),i,n)},function(e,t){var n=g(a,e,this,t);if(n.done)return n.value;var d=i(e),f=String(this),p="function"===typeof t;p||(t=String(t));var h=d.global;if(h){var b=d.unicode;d.lastIndex=0}var _=[];while(1){var y=o(d,f);if(null===y)break;if(_.push(y),!h)break;var k=String(y[0]);""===k&&(d.lastIndex=s(f,l(d.lastIndex),b))}for(var x="",w=0,I=0;I<_.length;I++){y=_[I];for(var S=String(y[0]),L=c(u(r(y.index),f.length),0),$=[],D=1;D<y.length;D++)$.push(m(y[D]));var O=y.groups;if(p){var T=[S].concat($,L,f);void 0!==O&&T.push(O);var j=String(t.apply(void 0,T))}else j=v(S,f,L,$,O,t);L>=w&&(x+=f.slice(w,L)+j,w=L+S.length)}return x+f.slice(w)}];function v(e,t,i,l,r,s){var o=i+e.length,c=l.length,u=p;return void 0!==r&&(r=n(r),u=f),a.call(s,u,(function(a,n){var s;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(o);case"<":s=r[n.slice(1,-1)];break;default:var u=+n;if(0===u)return a;if(u>c){var f=d(u/10);return 0===f?a:f<=c?void 0===l[f-1]?n.charAt(1):l[f-1]+n.charAt(1):a}s=l[u-1]}return void 0===s?"":s}))}}))},b0c5:function(e,t,a){"use strict";var i=a("520a");a("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},e036:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-dialog",{attrs:{visible:e.centerDialogVisible,title:"添加",width:"60%"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-tabs",{attrs:{value:"add"},on:{"tab-click":e.handleClick}},[a("el-tab-pane",{attrs:{name:"add",label:"添加"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"80px","element-loading-text":"添加中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.vulInfo.vul_name,callback:function(t){e.$set(e.vulInfo,"vul_name",t)},expression:"vulInfo.vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-col",{attrs:{span:17}},["file"===e.imgType?a("el-upload",{ref:"upload",attrs:{"http-request":e.uploadImg,accept:".tar",action:"/CombinationImage/",limit:1,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"medium",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1):e._e(),e._v(" "),"text"===e.imgType?a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"medium","fetch-suggestions":e.querySearchAsync},on:{select:e.handleSelect},model:{value:e.vulInfo.name,callback:function(t){e.$set(e.vulInfo,"name",t)},expression:"vulInfo.name"}}):e._e()],1),e._v(" "),a("el-col",{staticStyle:{float:"right",right:"0"},attrs:{span:5}},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){return t.stopPropagation(),e.changeType(t)}},model:{value:e.imgType,callback:function(t){e.imgType=t},expression:"imgType"}},[e._v(e._s(e.imgTypeText))])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择镜像标签"},model:{value:e.vulInfo.degree,callback:function(t){e.$set(e.vulInfo,"degree",t)},expression:"vulInfo.degree"}},e._l(e.degreeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.vulInfo.rank,callback:function(t){e.$set(e.vulInfo,"rank",t)},expression:"vulInfo.rank"}}),e._v("\n                 \n              "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.vulInfo.desc,callback:function(t){e.$set(e.vulInfo,"desc",t)},expression:"vulInfo.desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.uploadImg}},[e._v("提 交")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{name:"local",label:"本地导入"}},[a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.localSearch,callback:function(t){e.localSearch=t},expression:"localSearch"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.batchLocalAdd}},[e._v("\n              一键导入\n            ")]),e._v("   \n            "),a("el-tooltip",{attrs:{content:"一键导入默认导入分数为 2.5 分,漏洞名称为镜像名称,漏洞描述为漏洞名称",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.localLoading,expression:"localLoading"}],staticStyle:{width:"100%"},attrs:{data:e.localImageList.filter((function(t){return!e.localSearch||t.name.toLowerCase().includes(e.localSearch.toLowerCase())})),"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectLocalImages}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[!0===i.flag?a("el-tag",{attrs:{effect:"dark",type:"info"}},[e._v("已导入")]):!1===i.flag?a("el-tag",{attrs:{effect:"dark"}},[e._v("未导入")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLocalRemove(i.name)}}},[e._v("移除")])]}}])})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.progressShow,title:e.progress.title,width:"60%","before-close":e.closeProgress},on:{"update:visible":function(t){e.progressShow=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.progressLoading,expression:"progressLoading"}]},e._l(e.progress.layer,(function(t,i){return a("el-row",{staticStyle:{"margin-bottom":"10px",height:"24px"}},[a("el-tag",{staticStyle:{float:"left",width:"15%",height:"24px","line-height":"24px"},attrs:{align:"center"}},[e._v(e._s(t.id))]),e._v(" "),a("div",{staticStyle:{float:"left",width:"80%","margin-left":"10px"}},[100===t.progress?a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24,status:"success"}}):a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24}})],1)],1)})),1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.deleteShow,title:"删除",width:"80%"},on:{"update:visible":function(t){e.deleteShow=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.deleteContainerList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_name",width:"150","show-overflow-tooltip":!0,label:"漏洞名称"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"user_name",width:"100",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_host",width:"200","show-overflow-tooltip":!0,label:"访问地址"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tag",[e._v(e._s(i.container_status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_desc","show-overflow-tooltip":!0,width:"300",label:"漏洞描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"combination_desc",label:"操作","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["running"===i.container_status||"stop"===i.container_status?a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.delContainer(i)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.editShow,title:"修改"},on:{"update:visible":function(t){e.editShow=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoding,expression:"editLoding"}],attrs:{"label-width":"80px","element-loading-text":"修改中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.editVulInfo.image_vul_name,callback:function(t){e.$set(e.editVulInfo,"image_vul_name",t)},expression:"editVulInfo.image_vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editVulInfo.image_name,callback:function(t){e.$set(e.editVulInfo,"image_name",t)},expression:"editVulInfo.image_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择镜像标签"},model:{value:e.editVulInfo.degree,callback:function(t){e.$set(e.editVulInfo,"degree",t)},expression:"editVulInfo.degree"}},e._l(e.degreeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.editVulInfo.rank,callback:function(t){e.$set(e.editVulInfo,"rank",t)},expression:"editVulInfo.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.editVulInfo.image_desc,callback:function(t){e.$set(e.editVulInfo,"image_desc",t)},expression:"editVulInfo.image_desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleEditImage}},[e._v("提 交")])],1)],1)],1),e._v(" "),a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleQuery(1)}}},[e._v("\n      查询\n    ")]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-edit"},on:{click:e.openCreate}},[e._v("\n      添加\n    ")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",align:"center"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_name",label:"镜像名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_vul_name",label:"漏洞名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_port",label:"端口",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rank",label:"分数",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"漏洞分类",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return i.degree.length>0&&""!==i.degree?e._l(i.degree,(function(t){return a("el-tag",{staticStyle:{"margin-left":"2px"}},[e._v(e._s(t))])})):void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"image_desc","show-overflow-tooltip":!0,label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_date","show-overflow-tooltip":!0,label:"修改时间"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[!1===i.is_ok&&""!==i.status.task_id?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(i,1)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("下载中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:i.status.progress,width:20}})],1)]):!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadImg(i)}}},[e._v("下载")]):e._e(),e._v(" "),!0===i.is_ok||!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:function(t){return e.openEdit(i)}}},[e._v("修改")]):e._e(),e._v(" "),!0===i.is_ok||!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(i)}}},[e._v("删除")]):e._e(),e._v(" "),!0===i.is_ok&&!0===i.is_share?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{type:"success",effect:"dark"}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("已分享")])])]):e._e(),e._v(" "),!0===i.is_ok&&!1===i.is_share&&"share"!==i.status.progress_status?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-share"},on:{click:function(t){return e.shareImg(i)}}},[e._v("分享")]):e._e(),e._v(" "),!0===i.is_ok&&"share"===i.status.progress_status?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(i,2)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("分享中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:i.status.progress,width:20}})],1)]):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-size":e.page.size,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.handleQuery}})],1)],1)},n=[],l=(a("386d"),a("a481"),a("7f7f"),a("ac6a"),a("3007")),r=a("bc3a"),s=a.n(r);function o(e){var t="https://hub.docker.com/api/content/v1/products/search?page_size=50&q=vulfocus%2F"+e+"&type=image";return s()({method:"get",url:t,headers:{"Sec-Fetch-Site":"none","Sec-Fetch-Mode":"cors","Sec-Fetch-Dest":"empty","Accept-Encoding":"gzip, deflate","Accept-Language":"zh-CN,zh;q=0.9","Search-Version":"v3"}})}var c=a("b775");function u(e){return Object(c["a"])({url:"/images/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function d(e,t){return Object(c["a"])({url:"/images/"+e+"/edit/",method:"post",data:t})}function f(e){return Object(c["a"])({url:"/images/"+e+"/delete/"})}function p(){return Object(c["a"])({url:"/images/local/local/"})}function m(e){return Object(c["a"])({url:"/images/local/local_add/",method:"post",data:e})}function g(e){return Object(c["a"])({url:"/images/"+e+"/download/"})}function v(e){return Object(c["a"])({url:"/images/"+e+"/share/"})}var h=a("4dd0"),b=a("ea7f"),_={name:"index",data:function(){return{tableData:[],search:"",localSearch:"",centerDialogVisible:!1,startCon:!1,vulInfo:{rank:"",name:"",vul_name:"",desc:"",degree:[]},editShow:!1,editLoding:!1,degreeList:[{value:"命令执行",lable:"命令执行"},{value:"代码执行",lable:"代码执行"},{value:"文件写入",lable:"文件写入"},{value:"文件上传",lable:"文件上传"},{value:"后门",lable:"后门"},{value:"默认口令",lable:"默认口令"},{value:"弱口令",lable:"弱口令"},{value:"权限绕过",lable:"权限绕过"},{value:"未授权访问",lable:"未授权访问"},{value:"XXE漏洞",lable:"XXE漏洞"},{value:"SQL注入",lable:"SQL注入"},{value:"文件读取",lable:"文件读取"},{value:"文件下载",lable:"文件下载"},{value:"文件包含",lable:"文件包含"},{value:"文件删除",lable:"文件删除"},{value:"目录遍历",lable:"目录遍历"},{value:"信息泄漏",lable:"信息泄漏"},{value:"任意账户操作",lable:"任意账户操作"},{value:"XSS漏洞",lable:"XSS漏洞"},{value:"SSRF漏洞",lable:"SSRF漏洞"},{value:"CSRF漏洞",lable:"CSRF漏洞"}],editVulInfo:{rank:"",image_name:"",image_id:"",image_vul_name:"",image_desc:"",degree:[]},imgType:"text",imgTypeText:"切换为文件",loading:!1,summaries:[],taskCheckInterval:null,tmpImageNameList:[],localImageList:[],tmpLocalImageList:[],localLoading:!0,selectLocalImages:[],progressShow:!1,progressLoading:!1,deleteShow:!1,deleteContainerList:[],progress:{title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},taskList:[],taskDict:{},page:{total:0,size:20},value:[]}},created:function(){this.initTableData(),this.initSummariesList()},methods:{querySearchAsync:function(e,t){var a=this,i=this.summaries;null===e||""===e||0===e.length?(this.initSummariesList(),t(i)):o(e).then((function(e){if(a.summaries=[],200===e.status){var n=e.data["summaries"];null!=n&&n.forEach((function(e,t,i){a.summaries.push({value:e["name"]})})),i=a.summaries,t(i)}}))},searchSummariesList:function(e){var t=this;this.summaries=[],o(e).then((function(e){if(t.summaries=[],200===e.status){var a=e.data["summaries"];a.forEach((function(e,a,i){t.summaries.push({value:e["name"]})}))}}))},initSummariesList:function(){this.searchSummariesList("")},initTableData:function(){var e=this;clearInterval(this.taskCheckInterval),Object(l["e"])(void 0,!0,1).then((function(t){e.tableData=t.data.results,e.page.total=t.data.count,e.tableData.forEach((function(t,a,i){var n=t.image_name;e.tmpImageNameList.indexOf(n)>-1&&e.$notify({title:"成功",message:n+" 添加成功",type:"success"})}));var a=t.data.results;e.taskCheckInterval=window.setInterval((function(){setTimeout((function(){e.checkTask(a)}),0)}),2e3)}))},openCreate:function(){this.centerDialogVisible=!0,this.vulInfo.rank=2.5,this.vulInfo.name="",this.vulInfo.vul_name="",this.vulInfo.desc="",this.vulInfo.degree=[]},openProgress:function(e,t){var a=this;this.progress={title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},this.progressShow=!0,this.progressLoading=!0;var i=e.status.task_id;this.progress.title=1===t?"下载镜像："+e.image_name:"分享镜像："+e.image_name,this.progress.progressInterval=window.setInterval((function(){setTimeout((function(){a.progressLoading=!1,Object(b["c"])(i).then((function(e){null!=e.data.data&&200===e.data.status&&(a.progress.count=e.data.data.progress_count,a.progress.progress=e.data.data.progress,a.progress.total=e.data.data.total,a.progress.layer=e.data.data.layer,(100===a.progress.progress||0!==a.progress.count&&0!==a.progress.total&&a.progress.count===a.progress.total)&&(clearInterval(a.progress.progressInterval),a.progressShow=!1))}))}),1.5)}),2e3)},openEdit:function(e){this.editShow=!0,this.editVulInfo=e},handleEditImage:function(){var e=this;this.editLoding=!0,d(this.editVulInfo.image_id,this.editVulInfo).then((function(t){e.editLoding=!1;var a=t.data,i=a.msg;200===a.status?(e.$message({message:"修改成功!",type:"success"}),e.editShow=!1,e.initTableData()):e.$message({message:i,type:"error"})}))},closeProgress:function(){this.progressShow=!1,this.progressLoading=!1;try{clearInterval(this.progress.progressInterval)}catch(e){}},changeType:function(){"file"===this.imgType?(this.imgType="text",this.imgTypeText="切换为文件"):(this.imgType="file",this.imgTypeText="切换为文本")},uploadImg:function(){var e=this,t=new FormData;if(null!=this.$refs.upload){var a=this.$refs.upload.uploadFiles;(null!=this.$refs.upload.uploadFiles||this.$refs.upload.uploadFiles.length>0)&&t.set("file",a[0].raw)}t.set("rank",this.vulInfo.rank),t.set("image_name",this.vulInfo.name),t.set("image_vul_name",this.vulInfo.vul_name),t.set("image_desc",this.vulInfo.desc),t.set("degree",this.vulInfo.degree),this.loading=!0,u(t).then((function(t){e.loading=!1;var a=t.data,i=a["data"];if(null!=i&&(i.indexOf("成功")>-1||i.indexOf("失败")>-1)){var n=i.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");e.tmpImageNameList.push(n),i.indexOf("成功")>-1?(e.$notify({title:"成功",message:i,type:"success"}),e.centerDialogVisible=!1,e.initTableData()):(e.$notify({title:i,message:i,type:"error"}),e.centerDialogVisible=!1)}else e.$notify({title:"成功",message:a["msg"],type:"success"}),e.centerDialogVisible=!1,e.initTableData()}))},downloadImg:function(e){var t=this,a=e.image_id;g(a).then((function(e){var a=e.data,i=a["msg"];if(200===a.status)if(null!=i&&(i.indexOf("成功")>-1||i.indexOf("失败")>-1)){var n=i.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");t.tmpImageNameList.push(n),i.indexOf("成功")>-1?(t.$notify({title:"成功",message:i,type:"success"}),t.initTableData()):t.$notify({message:i,type:"error"})}else t.$notify({message:i,type:"error"});else t.$notify({message:i,type:"error"}),t.centerDialogVisible=!1}))},shareImg:function(e){var t=this;e.status.status="share",v(e.image_id).then((function(e){var a=e.data,i=a.status;200===i||t.$message({message:a.msg,type:"error"}),t.initTableData()}))},handleDelete:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){f(e.image_id).then((function(e){var a=e.data;200===a.status?(t.$message({title:"成功",message:"删除成功!",type:"success"}),t.initTableData()):(t.deleteShow=!0,t.deleteContainerList=a.data,t.$message({title:"失败",message:a.msg,type:"error"}))}))})).catch((function(){}))},handleQuery:function(e){var t=this;Object(l["e"])(this.search,!0,e).then((function(e){t.tableData=e.data.results,t.page.total=e.data.count}))},handleSelect:function(e){this.vulInfo.name=e.value,this.vulInfo.vul_name=e.value.replace("vulfocus/",""),this.vulInfo.desc=e.value.replace("vulfocus/","")},checkTask:function(e){var t=this;e.forEach((function(e,a,i){var n=e["is_ok"],l=e["status"]["task_id"],r=e["status"]["progress_status"];(!1===n&&null!=l&&""!==l||!0===n&&null!=l&&""!==l&&"share"===r)&&-1===t.taskList.indexOf(l)&&(t.taskList.push(l),t.taskDict[l]=e)}));var a=this.taskList.join(",");if(null!=a&&""!==a){var i=new FormData;i.set("task_ids",a),Object(b["a"])(i).then((function(e){var a=e.data.data;for(var i in a){var n=a[i],l=n["status"];if(1!==l)if(t.removeArray(t.taskList,i),t.taskDict[i].is_ok=!0,200===n["data"]["status"]){var r=n["data"]["data"];try{var s=r.replace('{"image_port":',"").replace("}","").replace(":","").replace('"',"").replace('"',"");t.taskDict[i].image_port=s}catch(o){}try{n["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[i].is_share=!0,t.taskDict[i].status.progress_status="")}catch(o){}t.$notify({message:n["data"]["msg"],type:"success"})}else{try{n["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[i].is_share=!1,t.taskDict[i].status.progress_status="")}catch(o){}t.$notify({message:n["data"]["msg"],type:"error"})}else t.taskDict[i].status.progress=n["progress"]}null!=t.taskList&&0!==t.taskList.length||(t.taskList=[],t.taskDict={},clearInterval(t.taskCheckInterval))}))}},removeArray:function(e,t){for(var a=0;a<e.length;a++)if(e[a]===t){e.splice(a,1);break}},loadLocalImages:function(){var e=this;this.localLoading=!0,p().then((function(t){var a=t.data,i=a.status,n=a.data;200===i&&(e.localImageList=n,e.tmpLocalImageList=n),e.localLoading=!1}))},handleClick:function(e,t){var a=e.name;"local"===a&&this.loadLocalImages()},handleLocalRemove:function(e){for(var t=0;t<this.localImageList.length;t++)if(this.localImageList[t].name===e){this.localImageList.splice(t,1);break}},handleSelectLocalImages:function(e){var t=[];for(var a in e)t.push(e[a].name);this.selectLocalImages=t},batchLocalAdd:function(){var e=this;if(0!==this.selectLocalImages.length){var t=new FormData;t.set("image_names",this.selectLocalImages.join(",")),m(t).then((function(t){var a=t.data,i=a.data,n=a.status;if(200===n){for(var l=0;l<i.length;l++){var r=i[l],s=r.replace(" ","").replace("拉取镜像","").replace("任务下发成功","");e.tmpImageNameList.push(s),e.$notify({title:"成功",message:r,type:"success"})}e.centerDialogVisible=!1,e.initTableData()}else 201===n?e.$notify({title:"失败",message:a["msg"],type:"info"}):e.$notify({title:"失败",message:a["msg"],type:"error"})}))}},delContainer:function(e){var t=this;Object(h["a"])(e.container_id).then((function(a){var i=a.data["data"],n=window.setInterval((function(){setTimeout((function(){Object(b["b"])(i).then((function(a){var i=a.data["status"],l=a.data;1001===i||(clearInterval(n),200===i?(t.$message({type:"success",message:"删除成功"}),f(e.image_id).then((function(e){var a=e.data;200!==a.status?t.deleteContainerList=a.data:(t.$message({type:"success",message:"删除成功"}),t.deleteShow=!1,t.initTableData())}))):t.$message({message:l["msg"],type:"error"}))}))}),1)}),1e3)}))}}},y=_,k=a("2877"),x=Object(k["a"])(y,i,n,!1,null,"112266ea",null);t["default"]=x.exports},ea7f:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return r}));var i=a("b775");function n(e){return Object(i["a"])({url:"/tasks/"+e+"/get/",method:"get"})}function l(e){return Object(i["a"])({url:"/tasks/batch/batch/",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/tasks/"+e+"/progress/",method:"get"})}}}]);
//# sourceMappingURL=chunk-192e2f18.50f729d9.js.map