(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56eacc2a"],{"06ee":function(t,e,i){"use strict";i("1e2e")},"0a7f":function(t,e,i){},"0cef":function(t,e,i){"use strict";i.d(e,"f",(function(){return n})),i.d(e,"g",(function(){return s})),i.d(e,"o",(function(){return r})),i.d(e,"i",(function(){return o})),i.d(e,"j",(function(){return l})),i.d(e,"a",(function(){return u})),i.d(e,"m",(function(){return c})),i.d(e,"k",(function(){return d})),i.d(e,"n",(function(){return h})),i.d(e,"b",(function(){return p})),i.d(e,"d",(function(){return m})),i.d(e,"p",(function(){return f})),i.d(e,"h",(function(){return g})),i.d(e,"c",(function(){return v})),i.d(e,"e",(function(){return y})),i.d(e,"l",(function(){return _}));var a=i("b775");function n(t){return Object(a["a"])({url:"/layout/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function s(t){return Object(a["a"])({url:"/layout/"+t+"/delete/"})}function r(t){return Object(a["a"])({url:"/img/upload/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function o(t){return Object(a["a"])({url:"/layout/?id="+t,method:"get"})}function l(t){return Object(a["a"])({url:"/layout/"+t+"/release/",method:"get"})}function u(t){return Object(a["a"])({url:"build/compose/",method:"post",data:t})}function c(t){return Object(a["a"])({url:"update/compose/",method:"post",data:t})}function d(){return Object(a["a"])({url:"show/compose/",method:"get"})}function h(t){return Object(a["a"])({url:"/file/upload/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function p(t){return Object(a["a"])({url:"/file/delete/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function m(t){return Object(a["a"])({url:"/download_layout_image/",method:"post",data:t})}function f(t){return Object(a["a"])({url:"/upload_zip_file/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function g(t){return Object(a["a"])({url:"/layout/"+t+"/download/",method:"get",responseType:"blob"})}function v(t){return Object(a["a"])({url:"/download/official/website/layout/",method:"post",data:t})}function y(){return Object(a["a"])({url:"get/official/website/layout",method:"get"})}function _(t,e){return Object(a["a"])({url:"/layout/"+t+"/update_desc/",method:"post",data:e})}},"0dec":function(t,e,i){t.exports=i("f292")},"11e9":function(t,e,i){var a=i("52a7"),n=i("4630"),s=i("6821"),r=i("6a99"),o=i("69a8"),l=i("c69a"),u=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?u:function(t,e){if(t=s(t),e=r(e,!0),l)try{return u(t,e)}catch(i){}if(o(t,e))return n(!a.f.call(t,e),t[e])}},"16d8":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:t.id}})},n=[],s=i("db72"),r=(i("a7be"),i("44f8"),i("a6e0"),i("2c43"),i("bff0"),i("1487"),i("547e")),o=i.n(r),l={minHeight:"500px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,viewer:!0,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},u={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return l}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var t=Object.assign({},l,this.options);return t.initialEditType=this.mode,t.height=this.height,t.language=this.language,t}},watch:{value:function(t,e){t!==e&&t!==this.editor.getValue()&&this.editor.setValue(t)},language:function(t){this.destroyEditor(),this.initEditor()},height:function(t){this.editor.height(t)},mode:function(t){this.editor.changeMode(t)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var t=this;this.editor=new o.a(Object(s["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){t.$emit("input",t.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(t){this.editor.setValue(t)},getValue:function(){return this.editor.getValue()},setHtml:function(t){this.editor.setHtml(t)},getHtml:function(){return this.editor.getHtml()}}},c=u,d=i("2877"),h=Object(d["a"])(c,a,n,!1,null,null,null);e["a"]=h.exports},"1e2e":function(t,e,i){},"36bd":function(t,e,i){"use strict";var a=i("4bf8"),n=i("77f1"),s=i("9def");t.exports=function(t){var e=a(this),i=s(e.length),r=arguments.length,o=n(r>1?arguments[1]:void 0,i),l=r>2?arguments[2]:void 0,u=void 0===l?i:n(l,i);while(u>o)e[o++]=t;return e}},"5dbc":function(t,e,i){var a=i("d3f4"),n=i("8b97").set;t.exports=function(t,e,i){var s,r=e.constructor;return r!==i&&"function"==typeof r&&(s=r.prototype)!==i.prototype&&a(s)&&n&&n(t,s),t}},"63da":function(t,e,i){"use strict";i("0a7f")},"6c7b":function(t,e,i){var a=i("5ca1");a(a.P,"Array",{fill:i("36bd")}),i("9c6c")("fill")},"8b97":function(t,e,i){var a=i("d3f4"),n=i("cb7c"),s=function(t,e){if(n(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,i){return s(t,i),e?t.__proto__=i:a(t,i),t}}({},!1):void 0),check:s}},"8e5f":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:t.id}})},n=[],s=i("db72"),r=(i("a7be"),i("44f8"),i("a6e0"),i("2c43"),i("16d8"),i("bff0")),o=i.n(r),l=i("1487"),u=i.n(l),c=i("547e"),d=i.n(c),h={minHeight:"500px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,viewer:!0,plugins:[[o.a,{hljs:u.a}]],toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},p={name:"ViewerEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-viewer-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return h}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var t=Object.assign({},h,this.options);return t.initialEditType=this.mode,t.height=this.height,t.language=this.language,t}},watch:{value:function(t,e){t!==e&&t!==this.editor.getValue()&&this.editor.setValue(t)},language:function(t){this.destroyEditor(),this.initEditor()},height:function(t){this.editor.height(t)},mode:function(t){this.editor.changeMode(t)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var t=this;this.editor=new d.a.factory(Object(s["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){t.$emit("input",t.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(t){this.editor.setValue(t)},getValue:function(){return this.editor.getValue()},setHtml:function(t){this.editor.setHtml(t)},getHtml:function(){return this.editor.getHtml()}}},m=p,f=i("2877"),g=Object(f["a"])(m,a,n,!1,null,null,null);e["a"]=g.exports},9093:function(t,e,i){var a=i("ce10"),n=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,n)}},aa63:function(t,e,i){t.exports=i.p+"static/img/modelbg.fcbe2049.jpg"},aa77:function(t,e,i){var a=i("5ca1"),n=i("be13"),s=i("79e5"),r=i("fdef"),o="["+r+"]",l="​",u=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),d=function(t,e,i){var n={},o=s((function(){return!!r[t]()||l[t]()!=l})),u=n[t]=o?e(h):r[t];i&&(n[i]=u),a(a.P+a.F*o,"String",n)},h=d.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=d},ba92:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"e",(function(){return s})),i.d(e,"f",(function(){return r})),i.d(e,"b",(function(){return o})),i.d(e,"d",(function(){return l})),i.d(e,"a",(function(){return u}));var a=i("b775");function n(t){return Object(a["a"])({url:"/layout/"+t+"/get/",method:"get"})}function s(t){return Object(a["a"])({url:"/layout/"+t+"/start/",method:"get"})}function r(t){return Object(a["a"])({url:"/layout/"+t+"/stop/",method:"get"})}function o(t,e){return Object(a["a"])({url:"/layout/"+t+"/flag/?flag="+e,method:"get"})}function l(t,e){return(void 0===e||null===e||e<1)&&(e=1),Object(a["a"])({url:"/layout/"+t+"/rank/?page="+e,method:"get"})}function u(t,e,i,n){return void 0!==t&&null!=t||(t=""),void 0!==i&&null!==i||(i="all"),(void 0===e||null===e||e<1)&&(e=1),void 0!==n&&null!==n||(n=""),Object(a["a"])({url:"/get/scenedata/?tag="+i+"&page="+e+"&query="+t+"&backstage="+n,method:"get"})}},c5f6:function(t,e,i){"use strict";var a=i("7726"),n=i("69a8"),s=i("2d95"),r=i("5dbc"),o=i("6a99"),l=i("79e5"),u=i("9093").f,c=i("11e9").f,d=i("86cc").f,h=i("aa77").trim,p="Number",m=a[p],f=m,g=m.prototype,v=s(i("2aeb")(g))==p,y="trim"in String.prototype,_=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=y?e.trim():h(e,3);var i,a,n,s=e.charCodeAt(0);if(43===s||45===s){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+e}for(var r,l=e.slice(2),u=0,c=l.length;u<c;u++)if(r=l.charCodeAt(u),r<48||r>n)return NaN;return parseInt(l,a)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof m&&(v?l((function(){g.valueOf.call(i)})):s(i)!=p)?r(new f(_(e)),i,m):_(e)};for(var b,x=i("9e1e")?u(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;x.length>w;w++)n(f,b=x[w])&&!n(m,b)&&d(m,b,c(f,b));m.prototype=g,g.constructor=m,i("2aba")(a,p,m)}},d4fe:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",[i("el-col",{attrs:{span:16}},[i("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingFlag,expression:"loadingFlag"}],attrs:{"element-loading-text":t.loadingText}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("场景信息")]),t._v(" "),t.isRun?t._e():i("el-tooltip",{attrs:{content:"运行中"}},[i("i",{staticClass:"el-icon-loading",staticStyle:{color:"#20a0ff"}})]),t._v(" "),t.isRun?i("el-tooltip",{attrs:{content:"未启动"}},[i("i",{staticClass:"fa fa-stop",attrs:{"aria-hidden":"true"}})]):t._e()],1),t._v(" "),i("el-container",[i("el-aside",{attrs:{width:"356px"}},[t.layout.image_name!==t.imgpath?i("img",{attrs:{src:t.layout.image_name,alt:"",width:"356px",height:"248px"}}):t._e()]),t._v(" "),i("el-main",{staticStyle:{"margin-top":"-15px"}},[i("el-row",[i("el-col",{attrs:{span:19}},[i("span",{staticClass:"info2"},[t._v(t._s(t.layout.name))])])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"15px"}},[i("el-col",{attrs:{span:5}},[i("span",{staticClass:"info3"},[t._v("难易程度")])]),t._v(" "),i("el-col",{attrs:{span:19}},[i("el-rate",{attrs:{disabled:"","show-score":"","text-color":"#ff9900","score-template":"{value}"},model:{value:t.difvalue,callback:function(e){t.difvalue=e},expression:"difvalue"}})],1)],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:5}},[i("span",{staticClass:"info3"},[t._v("当前进度")])]),t._v(" "),i("el-col",{attrs:{span:19}},[i("el-progress",{staticStyle:{width:"90%",color:"#2a58e8"},attrs:{"text-inside":!0,"stroke-width":20,color:"rgba(64, 158, 255, 1)",percentage:parseFloat(t.currentProgress),status:"success"}})],1)],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:5}},[i("span",{staticClass:"info3"},[t._v("当前排名")])]),t._v(" "),i("el-col",{attrs:{span:19}},[0===t.currentRank?i("span",[t._v("\n                    未上榜\n                  ")]):t.currentRank>0?i("span",[t._v("\n                    "+t._s(t.currentRank)+"\n                  ")]):t._e()])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"20px"}},[i("el-col",{attrs:{span:5}},[i("span",{staticClass:"info3",staticStyle:{"margin-bottom":"auto"}},[t._v("Flag")])]),t._v(" "),i("el-col",{attrs:{span:19}},[i("el-input",{staticStyle:{width:"80%"},attrs:{disabled:t.isRun,size:"small",placeholder:"请输入Flag：格式flag-{xxxxxxxx}"},model:{value:t.flag,callback:function(e){t.flag=e},expression:"flag"}}),t._v(" "),i("el-button",{staticStyle:{color:"rgba(64, 158, 255, 1)"},attrs:{size:"small",disabled:t.isRun,type:"text"},on:{click:t.handleFlag}},[t._v("提交")])],1)],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"12px"}},[!0===t.isAdmin&&t.isRun?i("el-button",{staticClass:"btn1",attrs:{size:"medium"},on:{click:t.handleRun}},[i("span",{staticClass:"span1"},[i("i",{staticClass:"el-icon-video-play",staticStyle:{"margin-right":"2px"}}),t._v("启动场景")])]):t._e(),t._v(" "),!0!==t.isAdmin||t.isRun?t._e():i("el-button",{staticClass:"btn1",attrs:{size:"small"},on:{click:t.handleStop}},[i("span",{staticClass:"span1"},[i("i",{staticClass:"el-icon-loading",staticStyle:{"margin-right":"2px"}}),t._v("停止场景")])]),t._v("\n                该场景已有\n                "),i("span",{staticClass:"span5"},[t._v(t._s(t.adoptCount))]),t._v("\n                人完成/\n                "),i("span",{staticClass:"span6"},[t._v(t._s(t.failCount))]),t._v("\n                人未通过\n              ")],1)],1),t._v(" "),i("el-aside",{attrs:{width:"60px"}},[i("el-row",[i("el-col",[i("span",{staticClass:"txt8"},[t._v(t._s(t.currentScore))]),t._v(" "),i("span",{staticClass:"word5"},[t._v("分")])])],1)],1)],1),t._v(" "),i("el-divider"),t._v(" "),i("el-container",[i("el-main",[i("el-row",[i("span",{staticClass:"span2"},[t._v("环境描述")]),t._v(" "),!0===t.isAdmin?i("el-link",{attrs:{type:"primary",size:"mini"},on:{click:t.openDrawer}},[t._v("编辑")]):t._e()],1),t._v(" "),i("el-row",[i("div",{staticClass:"container",staticStyle:{"margin-top":"24px"}},[t.loadingData?i("ViewerEditor",{ref:"viewerEditor1",attrs:{options:{hideModeSwitch:!0,previewStyle:"vertical"},height:"500px"},model:{value:t.scene_writeup_date,callback:function(e){t.scene_writeup_date=e},expression:"scene_writeup_date"}}):t._e()],1)]),t._v(" "),i("el-row",{staticStyle:{"margin-top":"24px"}},[i("span",{staticClass:"span2"},[t._v("访问地址")])]),t._v(" "),t._l(t.open,(function(e,a){return i("el-row",{staticStyle:{"margin-top":"24px"}},[i("span",{staticClass:"span3"},[t._v(" "+t._s(e)+" ")])])}))],2)],1)],1),t._v(" "),i("el-card",{staticStyle:{"margin-top":"20px"}},[i("el-row",[i("el-col",[i("span",[t._v("评论")]),t._v(" "),i("el-divider"),t._v(" "),i("el-input",{attrs:{rows:"5",type:"textarea",placeholder:"既然来了就说点什么吧～",maxlength:"500","show-word-limit":""},model:{value:t.contentText,callback:function(e){t.contentText=e},expression:"contentText"}}),t._v(" "),i("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{size:"small",type:"primary"},on:{click:t.handleText}},[t._v("发表")])],1)],1),t._v(" "),i("el-row",t._l(t.contentList,(function(e,a){return i("el-col",{key:a},[i("el-card",{staticStyle:{"margin-top":"10px"}},[i("el-container",[i("el-aside",{staticStyle:{"margin-top":"7px"},attrs:{width:"48px"}},[[i("img",{staticStyle:{width:"48px",height:"48px","border-radius":"50%",float:"left","margin-top":"10px"},attrs:{src:e.user_avatar}})]],2),t._v(" "),i("el-main",[i("el-row",[i("el-col",{attrs:{span:3}},[i("span",{staticClass:"span7"},[t._v("\n                        "+t._s(e.username)+"\n                      ")])]),t._v(" "),i("el-col",{attrs:{span:20}},[i("span",{staticClass:"span8"},[t._v("\n                        "+t._s(e.create_time)+"\n                      ")])])],1),t._v(" "),i("el-row",{staticStyle:{"margin-top":"5px"}},[i("span",[t._v(t._s(e.content))]),t._v(" "),!0===t.isAdmin||t.userAuth===e.username?i("el-button",{staticStyle:{float:"right","margin-top":"-5px"},attrs:{size:"mini"},on:{click:function(i){return t.delComment(e.comment_id)}}},[t._v("\n                      删除\n                     ")]):t._e()],1)],1)],1)],1)],1)})),1)],1)],1),t._v(" "),i("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:7}},[i("el-card",[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("场景排名")])]),t._v(" "),i("div",[i("el-table",{attrs:{data:t.rankList}},[i("el-table-column",{attrs:{type:"index",label:"排名",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.page.currentPageNum*t.page.size+e.$index+1-t.page.size>=4?i("p",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.page.currentPageNum*t.page.size+e.$index+1-t.page.size))]):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===1?i("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy1"}}):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===2?i("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy2"}}):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===3?i("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy3"}}):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"username","show-overflow-tooltip":!0,label:"用户"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{width:"30px",height:"30px","border-radius":"50%",float:"left","margin-top":"10px"},attrs:{src:e.row.user_avatar}}),t._v(" "),i("p",{staticStyle:{float:"left","margin-left":"5px","margin-top":"14px"}},[t._v(t._s(e.row.username))])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"score",label:"积分",width:"80"}})],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-pagination",{attrs:{"page-size":t.page.size,layout:"total, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.handleRank}})],1)])],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},[i("el-dialog",{attrs:{visible:t.dialogVisible,title:"请输入验证码",width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-form",[i("el-form-item",[i("el-row",{attrs:{span:24}},[i("el-col",{attrs:{span:8}},[i("el-input",{attrs:{"auto-complete":"off",placeholder:"请输入验证码"},model:{value:t.commentCode,callback:function(e){t.commentCode=e},expression:"commentCode"}})],1),t._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"login-code"},[i("v-sidentify",{on:{getIdentifyCode:t.identifyCode}})],1)])],1),t._v(" "),i("el-row",[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.commitText}},[t._v("确认")])],1)],1)],1)],1)],1),t._v(" "),i("div",{staticStyle:{"margin-top":"20px"}},[t.drawer?i("el-drawer",{attrs:{visible:t.drawer,size:"50%",direction:t.derection,modal:"false","append-to-body":"true","before-close":t.closeDrawer}},[i("div",{staticStyle:{"margin-right":"10px"}},[i("el-button",{staticStyle:{position:"absolute","z-index":"9999",right:"60px",top:"21px"},attrs:{icon:"el-icon-edit-outline",size:"small"},on:{click:t.createSceneWriteup}},[t._v("修改")])],1),t._v(" "),i("div",[i("el-row",[i("el-col",{attrs:{span:22,offset:1}},[i("div",{staticClass:"container"},[i("markdown-editor",{ref:"markdownEditor1",attrs:{options:{hideModeSwitch:!0,previewStyle:"vertical"},height:"400px"},model:{value:t.scene_update_date,callback:function(e){t.scene_update_date=e},expression:"scene_update_date"}})],1)])],1)],1)]):t._e()],1)],1)},n=[],s=(i("7f7f"),i("db72")),r=i("bd86"),o=i("2f62"),l=i("ba92"),u=i("c24f"),c=(i("0dec"),i("0cef")),d=i("ef67"),h=i("16d8"),p=i("8e5f"),m={inject:["reload"],name:"timeindex.vue",data:function(){return Object(r["a"])({layout:{id:"",name:"",desc:"",image_name:""},loadingFlag:!0,loadingText:"环境启动中",flag:"",isAdmin:!1,page:{total:0,size:20,page:1,currentPageNum:1},isRun:!1,currentProgress:"",currentRank:0,currentScore:0,adoptCount:0,failCount:0,incompletePeple:0,open:[],rankList:[],scene_writeup_date:"",scene_update_date:"",drawer:!1,drawerFlag:!1,derection:"btt",imgpath:"/images/",difvalue:3.5,contentText:"",contentList:[],dialogVisible:!1,verificationCode:"",commentCode:"",loadingData:!1,userAuth:""},"loadingData",!1)},computed:Object(s["a"])({},Object(o["b"])(["name","avatar","roles","rank"])),created:function(){this.roles.length>0&&"admin"===this.roles[0]&&(this.isAdmin=!0),this.userAuth=this.name,this.initModelInfo(),this.handleRank(1),this.initComment()},components:{"v-sidentify":d["a"],MarkdownEditor:h["a"],ViewerEditor:p["a"]},methods:{identifyCode:function(t){this.verificationCode=t},initModelInfo:function(){var t=this;this.loadingText="模式信息初始化中",this.loadingFlag=!0;var e=this.$route.query.layout_id;void 0!==e&&null!=e&&""!==e||(this.$message({message:"参数不能为空",type:"error"}),this.$router.push({path:"/scene/list"})),this.layout.id=e,Object(l["c"])(e).then((function(e){t.loadingFlag=!1;var a=e.data,n=a.status,s=a.msg;200===n?(t.layout.name=a.data["layout"]["name"],t.layout.desc=a.data["layout"]["desc"],t.scene_writeup_date=a.data["layout"]["desc"],t.loadingData=!0,a.data["layout"]["image_name"]?t.layout.image_name="/images/"+a.data["layout"]["image_name"]:t.layout.image_name=i("aa63"),t.open=a.data["open"],a.data["is_run"]||(t.isRun=!0)):t.$message({message:s,type:"error"})})).catch((function(e){t.loadingFlag=!1,t.$message({message:"服务器内部错误",type:"error"}),t.$router.push({path:"/scene/list"})}))},handleRun:function(){var t=this;this.loadingFlag=!0,this.loadingText="模式启动中";var e=this.layout.id;void 0!==e&&null!=e&&""!==e||(this.$message({message:"参数不能为空",type:"error"}),this.$router.push({path:"/scene/list"})),Object(l["e"])(e).then((function(e){t.loadingFlag=!1;var i=e.data,a=i.status,n=i.msg;200===a?(t.layout.name=i.data["layout"]["name"],t.layout.desc=i.data["layout"]["desc"],t.open=i.data["open"],void 0===i.data["is_run"]&&(i.data["is_run"]=!0),t.isRun=!i.data["is_run"],t.$message({message:"启动成功",type:"success"})):t.$message({message:n,type:"error"})})).catch((function(e){t.loadingFlag=!1,t.$message({message:"服务器内部错误",type:"error"}),t.$router.push({path:"/scene/list"})}))},handleStop:function(){var t=this;this.loadingFlag=!0,this.loadingText="模式停止中";var e=this.layout.id;void 0!==e&&null!=e&&""!==e||(this.$message({message:"参数不能为空",type:"error"}),this.$router.push({path:"/scene/list"})),Object(l["f"])(e).then((function(e){t.loadingFlag=!1;var i=e.data,a=i.status,n=i.msg;200===a?(t.$message({message:"关闭成功",type:"success"}),t.initModelInfo()):t.$message({message:n,type:"error"})})).catch((function(e){t.loadingFlag=!1,t.$message({message:"服务器内部错误",type:"error"})}))},handleFlag:function(){var t=this,e=this.flag;this.loadingFlag=!0,this.loadingText="Flag 提交中",""!==e&&null!==e?Object(l["b"])(this.layout.id,e).then((function(e){t.loadingFlag=!1;var i=e.data,a=i.status;200===a?(t.$message({message:"恭喜！通过",type:"success"}),t.flag="",t.handleRank(1)):t.$message({message:i.msg,type:"error"})})).catch((function(e){t.loadingFlag=!1,t.$message({message:"服务器内部错误",type:"error"})})):this.$message({message:"flag 不能为空",type:"error"})},handleRank:function(t){var e=this;this.loadingFlag=!0,this.loadingText="排行初始化中",this.page.page=t,this.page.currentPageNum=t,Object(l["d"])(this.layout.id,t).then((function(t){e.loadingFlag=!1;var i=t.data;e.page.total=i.count,e.rankList=i.result,e.currentProgress=i.progress,e.currentRank=i.current,e.currentScore=i.score,e.adoptCount=i.adopt_count,e.failCount=e.page.total-e.adoptCount})).catch((function(t){e.loadingFlag=!1,e.$message({message:"服务器内部错误",type:"error"})}))},computeTableIndex:function(t){return(this.page.page-1)*this.page.size+t+1},handleText:function(){this.dialogVisible=!0},commitText:function(){var t=this;if(this.commentCode===this.verificationCode){var e=new FormData;e.set("scene_id",this.$route.query.layout_id),e.set("content",this.contentText),e.set("scene_type","layout"),Object(u["d"])(e).then((function(e){200===e.data.status?(t.$message({message:e.data.message,type:"success"}),t.dialogVisible=!1,t.reload()):t.$message({message:e.data.message,type:"error"})}))}else this.$message({message:"验证码错误",type:"error"})},initComment:function(){var t=this,e=this.$route.query.layout_id;Object(u["e"])(e).then((function(e){t.contentList=e.data.results}))},delComment:function(t){var e=this;Object(u["a"])(t).then((function(t){200===t.data.status?(e.$message({message:"删除成功",type:"success"}),e.initComment()):e.$message({message:t.data.msg,type:"error"})}))},closeDrawer:function(){this.drawer=!1,this.initModelInfo()},openDrawer:function(){this.scene_update_date=this.scene_writeup_date,this.drawer=!0},createSceneWriteup:function(){var t=this,e=this.$route.query.layout_id,i={data:this.scene_update_date};Object(c["l"])(e,i).then((function(e){200===e.data.status?(t.$message({message:"编辑成功",type:"success"}),t.drawer=!1,t.reload()):t.$message({message:e.data.msg,type:"error"})}))}}},f=m,g=(i("63da"),i("2877")),v=Object(g["a"])(f,a,n,!1,null,"b9c8e7c2",null);e["default"]=v.exports},ef67:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"s-canvas",on:{click:t.createdCode}},[i("canvas",{attrs:{id:"s-canvas",width:t.contentWidth,height:t.contentHeight}})])},n=[],s=(i("6c7b"),i("c5f6"),i("2b0e")),r=s["default"].extend({props:{fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:120},contentHeight:{type:Number,default:34}},data:function(){return{identifyCode:""}},mounted:function(){this.createdCode()},methods:{createdCode:function(){for(var t=4,e=[],i="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",a=i.length,n=0;n<t;n++)e.push(i.charAt(Math.floor(Math.random()*a)));this.identifyCode=e.join(""),this.$emit("getIdentifyCode",this.identifyCode.toLowerCase()),this.drawPic()},randomNum:function(t,e){return Math.floor(Math.random()*(e-t)+t)},randomColor:function(t,e){var i=this.randomNum(t,e),a=this.randomNum(t,e),n=this.randomNum(t,e);return"rgb("+i+","+a+","+n+")"},drawPic:function(){var t=document.getElementById("s-canvas"),e=t.getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(var i=0;i<this.identifyCode.length;i++)this.drawText(e,this.identifyCode[i],i);this.drawLine(e),this.drawDot(e)},drawText:function(t,e,i){t.fillStyle=this.randomColor(this.colorMin,this.colorMax),t.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";var a=(i+1)*(this.contentWidth/(this.identifyCode.length+1)),n=this.randomNum(this.fontSizeMax,this.contentHeight-5),s=this.randomNum(-45,45);t.translate(a,n),t.rotate(s*Math.PI/180),t.fillText(e,0,0),t.rotate(-s*Math.PI/180),t.translate(-a,-n)},drawLine:function(t){for(var e=0;e<5;e++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot:function(t){for(var e=0;e<80;e++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()}}}),o=r,l=(i("06ee"),i("2877")),u=Object(l["a"])(o,a,n,!1,null,"1879e85c",null);e["a"]=u.exports},f292:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.msTime.show?i("p",[t.msTime.day>0?i("span",[i("span",[t._v(t._s(t.msTime.day))]),i("i",[t._v(t._s(t.dayTxt))])]):t._e(),t._v(" "),i("span",[t._v(t._s(t.msTime.hour))]),i("i",[t._v(t._s(t.hourTxt))]),t._v(" "),i("span",[t._v(t._s(t.msTime.minutes))]),i("i",[t._v(t._s(t.minutesTxt))]),t._v(" "),i("span",[t._v(t._s(t.msTime.seconds))]),i("i",[t._v(t._s(t.secondsTxt))])]):t._e()])},n=[],s=(i("6b54"),i("c5f6"),{replace:!0,data:function(){return{tipShow:!0,msTime:{show:!1,day:"",hour:"",minutes:"",seconds:""},star:"",end:"",current:""}},watch:{currentTime:function(t,e){this.gogogo()}},props:{tipText:{type:String,default:"距离开始"},tipTextEnd:{type:String,default:"距离结束"},id:{type:String,default:"1"},currentTime:{type:Number},startTime:{type:Number},endTime:{type:Number},endText:{type:String,default:"已结束"},dayTxt:{type:String,default:":"},hourTxt:{type:String,default:":"},minutesTxt:{type:String,default:":"},secondsTxt:{type:String,default:":"},secondsFixed:{type:Boolean,default:!1}},mounted:function(){console.log(this),this.gogogo()},methods:{gogogo:function(){var t=this;10==this.startTime.toString().length?this.star=1e3*this.startTime:this.star=this.startTime,10==this.endTime.toString().length?this.end=1e3*this.endTime:this.end=this.endTime,this.currentTime?10==this.currentTime.toString().length?this.current=1e3*this.currentTime:this.current=this.currentTime:this.current=(new Date).getTime(),this.end<this.current?(this.msTime.show=!1,this.end_message()):this.current<this.star?(this.$set(this,"tipShow",!0),setTimeout((function(){t.runTime(t.star,t.current,t.start_message)}),1)):(this.end>this.current&&this.star<this.current||this.star==this.current)&&(this.$set(this,"tipShow",!1),this.msTime.show=!0,this.$emit("start_callback",this.msTime.show),setTimeout((function(){t.runTime(t.end,t.star,t.end_message,!0)}),1))},runTime:function(t,e,i,a){var n=this,s=this.msTime,r=t-e;if(r>0){this.msTime.show=!0,s.day=Math.floor(r/864e5),r-=864e5*s.day,s.hour=Math.floor(r/36e5),r-=36e5*s.hour,s.minutes=Math.floor(r/6e4),r-=6e4*s.minutes,s.seconds=Math.floor(r/1e3).toFixed(0),r-=1e3*s.seconds,s.hour<10&&(s.hour="0"+s.hour),s.minutes<10&&(s.minutes="0"+s.minutes),s.seconds<10&&(s.seconds="0"+s.seconds);var o=Date.now(),l=Date.now(),u=l-o;setTimeout((function(){a?n.runTime(n.end,e+=1e3,i,!0):n.runTime(n.star,e+=1e3,i)}),1e3-u)}else i()},start_message:function(){var t=this;this.$set(this,"tipShow",!1),this.$emit("start_callback",this.msTime.show),setTimeout((function(){t.runTime(t.end,t.star,t.end_message,!0)}),1)},end_message:function(){this.msTime.show=!1,this.currentTime<=0||this.$emit("end_callback",this.msTime.show)}}}),r=s,o=i("2877"),l=Object(o["a"])(r,a,n,!1,null,null,null);e["default"]=l.exports},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-56eacc2a.fae16544.js.map