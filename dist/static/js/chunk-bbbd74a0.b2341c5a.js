(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bbbd74a0"],{"02f4":function(t,e,o){var a=o("4588"),n=o("be13");t.exports=function(t){return function(e,o){var i,r,s=String(n(e)),c=a(o),d=s.length;return c<0||c>=d?t?"":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===d||(r=s.charCodeAt(c+1))<56320||r>57343?t?s.charAt(c):i:t?s.slice(c,c+2):r-56320+(i-55296<<10)+65536)}}},"0390":function(t,e,o){"use strict";var a=o("02f4")(!0);t.exports=function(t,e,o){return e+(o?a(t,e).length:1)}},"0a49":function(t,e,o){var a=o("9b43"),n=o("626a"),i=o("4bf8"),r=o("9def"),s=o("cd1c");t.exports=function(t,e){var o=1==t,c=2==t,d=3==t,l=4==t,h=6==t,u=5==t||h,f=e||s;return function(e,s,p){for(var g,m,v=i(e),N=n(v),y=a(s,p,3),A=r(N.length),w=0,x=o?f(e,A):c?f(e,0):void 0;A>w;w++)if((u||w in N)&&(g=N[w],m=y(g,w,v),t))if(o)x[w]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:x.push(g)}else if(l)return!1;return h?-1:d||l?l:x}}},"0cef":function(t,e,o){"use strict";o.d(e,"a",(function(){return n})),o.d(e,"b",(function(){return i})),o.d(e,"e",(function(){return r})),o.d(e,"c",(function(){return s})),o.d(e,"d",(function(){return c}));var a=o("b775");function n(t){return Object(a["a"])({url:"/layout/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function i(t){return Object(a["a"])({url:"/layout/"+t+"/delete/"})}function r(t){return Object(a["a"])({url:"/img/upload/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:t})}function s(t,e,o){return void 0!==e&&null!==e||(e=1),void 0!==t&&null!=t||(t=""),void 0!==o&&null!==o&&""!==o||(o=""),Object(a["a"])({url:"/layout/?query="+t+"&page="+e+"&flag="+o,method:"get"})}function c(t){return Object(a["a"])({url:"/layout/"+t+"/release/",method:"get"})}},1169:function(t,e,o){var a=o("2d95");t.exports=Array.isArray||function(t){return"Array"==a(t)}},"11e9":function(t,e,o){var a=o("52a7"),n=o("4630"),i=o("6821"),r=o("6a99"),s=o("69a8"),c=o("c69a"),d=Object.getOwnPropertyDescriptor;e.f=o("9e1e")?d:function(t,e){if(t=i(t),e=r(e,!0),c)try{return d(t,e)}catch(o){}if(s(t,e))return n(!a.f.call(t,e),t[e])}},"162e":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.editable,expression:"editable"}],staticClass:"svgHead",attrs:{inline:!0}},[o("div",{staticClass:"svgHeadItemLst svgToolBarItem"},[o("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回",placement:"top-start"}},[o("el-button",{staticStyle:{margin:"0"},attrs:{size:"small",icon:"fa fa-backward"},on:{click:t.goBack}})],1)],1),t._v(" "),o("div",{staticClass:"svgHeadItemLst svgToolBarItem"},[o("el-button",{staticStyle:{margin:"3px"},attrs:{size:"small",type:"primary",icon:"fa fa-save"},on:{click:t.saveTopoJson}},[t._v(" 保存\n      ")])],1)]),t._v(" "),o("div",{staticClass:"svgMain"},[o("v-shapebar",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticStyle:{"min-height":"calc(100vh - 140px)"},on:{click:t.dragShapeNode}}),t._v(" "),o("div",{ref:"topoWrap",staticClass:"topoWrap",attrs:{id:"topoId"+t.topoId}},[o("svg",{staticClass:"topoSvg",class:{hand:t.svgAttr.isHand,crosshair:t.svgAttr.isCrosshair},attrs:{width:t.svgAttr.width,height:t.svgAttr.height,viewBox:t.svgAttr.viewX+" "+t.svgAttr.viewY+" "+t.svgAttr.width+" "+t.svgAttr.height},on:{mousedown:function(e){return e.stopPropagation(),t.mousedownTopoSvg(e)}}},[o("defs",[o("pattern",{attrs:{id:"Pattern",x:"0",y:"0",width:"100",height:"100",patternUnits:"userSpaceOnUse"}},t._l(t.gridData,(function(t){return o("line",{key:t.id,attrs:{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,stroke:t.color,"stroke-width":t.strokeWidth,opacity:t.opacity}})})),0)]),t._v(" "),o("defs",[o("filter",{attrs:{id:"f1",x:"0",y:"0",width:"200%",height:"200%",filterUnits:"userSpaceOnUse"}},[o("feOffset",{attrs:{result:"offOut",in:"SourceGraphic",dx:"4",dy:"4"}}),t._v(" "),o("feColorMatrix",{attrs:{result:"matrixOut",in:"offOut",type:"matrix",values:"0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0"}}),t._v(" "),o("feGaussianBlur",{attrs:{result:"blurOut",in:"matrixOut",stdDeviation:"2"}}),t._v(" "),o("feBlend",{attrs:{in:"SourceGraphic",in2:"blurOut",mode:"normal"}})],1)]),t._v(" "),o("rect",{attrs:{fill:"url(#Pattern)",width:t.svgAttr.width,height:t.svgAttr.height}}),t._v(" "),o("g",[t._l(t.topoData.nodes,(function(e,a){return o("g",{key:e.id,staticClass:"nodesG",class:{isSelect:e.isSelect,hoverShowConnectorArror:t.editable},attrs:{transform:"translate("+e.x+","+e.y+")"},on:{mouseover:function(e){return e.stopPropagation(),t.mouseoverNode(a,e)},mousedown:function(e){return e.stopPropagation(),t.dragSvgNode(a,e)},mouseout:function(e){return e.stopPropagation(),t.mouseoutLeftConnector(a)}}},[o("rect",{staticClass:"reactClass",attrs:{x:"0",y:"0",rx:"2",ry:"2",width:e.width,height:e.height}}),t._v(" "),"T1"==e.classType?o("text",{staticClass:"nodeName",attrs:{x:"5",y:"15"}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"T1"==e.classType?o("image",{staticClass:"nodeImg",attrs:{"xlink:href":e.icon,x:e.width-18,y:3,height:"15px",width:"15px"}}):t._e(),t._v(" "),"T2"==e.classType?o("image",{staticClass:"nodeImg",attrs:{"xlink:href":e.icon,x:7,y:7,height:"36px",width:"36px"}}):t._e(),t._v(" "),"{}"!==JSON.stringify(e.attrs)&&"Container"===e.type?o("foreignObject",{staticStyle:{"text-overflow":"ellipsis",fill:"#768699",color:"#768699"},attrs:{width:e.width-30,height:e.height,x:"5",y:"30"}},[o("text",{staticClass:"nodeName",attrs:{x:"5",y:"30"}},[t._v("镜像名称："+t._s(e.attrs.name))]),t._v(" "),o("br"),t._v(" "),o("text",{staticClass:"nodeName",attrs:{x:"5",y:"50"}},[t._v("漏洞名称："+t._s(e.attrs.vul_name))]),t._v(" "),o("br"),t._v(" "),o("text",{staticClass:"nodeName",attrs:{x:"5",y:"90"}},[t._v("端口："+t._s(e.attrs.port))]),o("br"),t._v(" "),o("text",{staticClass:"nodeName",attrs:{x:"5",y:"70"}},[t._v("是否开放："+t._s(e.attrs.open))]),o("br")]):t._e(),t._v(" "),"{}"!==JSON.stringify(e.attrs)&&"Network"===e.type?o("foreignObject",{staticStyle:{"text-overflow":"ellipsis",fill:"#768699",color:"#768699"},attrs:{width:e.width-30,height:e.height,x:"5",y:"30"}},[o("text",{staticClass:"nodeName",attrs:{x:"5",y:"30"}},[t._v("网卡名称："+t._s(e.attrs.name))]),t._v(" "),o("br"),t._v(" "),o("text",{staticClass:"nodeName",attrs:{x:"5",y:"50"}},[t._v("网关："+t._s(e.attrs.gateway))]),t._v(" "),o("br"),t._v(" "),o("text",{staticClass:"nodeName",attrs:{x:"5",y:"90"}},[t._v("子网："+t._s(e.attrs.subnet))]),o("br")]):t._e(),t._v(" "),o("g",{staticClass:"connectorArror",class:{connector:e.isLeftConnectShow},attrs:{transform:"translate(0,"+e.height/2+")"}},[o("circle",{staticClass:"circleColor",attrs:{r:"8",cx:"0",cy:"0"}}),t._v(" "),o("line",{attrs:{x1:"-3",y1:"-5",x2:"4",y2:"0.5",stroke:"#fff"}}),t._v(" "),o("line",{attrs:{x1:"4",y1:"-0.5",x2:"-3",y2:"5",stroke:"#fff"}})]),t._v(" "),o("g",{staticClass:"connectorArror",class:{connector:e.isRightConnectShow},attrs:{transform:"translate("+e.width+","+e.height/2+")"},on:{mousedown:function(e){return e.stopPropagation(),t.drawConnectLine(a,e)}}},[o("circle",{staticClass:"circleColor",attrs:{r:"8",cx:"0",cy:"0"}}),t._v(" "),o("line",{attrs:{x1:"-3",y1:"-5",x2:"4",y2:"0.5",stroke:"#fff"}}),t._v(" "),o("line",{attrs:{x1:"4",y1:"-0.5",x2:"-3",y2:"5",stroke:"#fff"}})])],1)})),t._v(" "),t._l(t.topoData.connectors,(function(e,a){return"Line"==e.type?o("g",{key:e.id,staticClass:"connectorsG",class:{active:e.isSelect},on:{mousedown:function(e){return e.stopPropagation(),t.selectConnectorLine(a)}}},[e.sourceNode.id==e.targetNode.id?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+t.connectorWSelf+"v"+-(e.sourceNode.height/2+t.connectorWSelf)+"h"+-(e.sourceNode.width+2*t.connectorWSelf)+"v"+(e.sourceNode.height/2+t.connectorWSelf)+"H"+e.targetNode.x}}):t._e(),t._v(" "),e.sourceNode.id!=e.targetNode.id&&e.sourceNode.x+e.sourceNode.width<e.targetNode.x?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+(e.targetNode.x-e.sourceNode.x-e.sourceNode.width)/2+"V"+(e.targetNode.y+e.targetNode.height/2)+"H"+e.targetNode.x}}):t._e(),t._v(" "),e.sourceNode.id!=e.targetNode.id&&e.sourceNode.x+e.sourceNode.width>=e.targetNode.x&&e.sourceNode.y+e.sourceNode.height<e.targetNode.y?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+t.connectorWSelf+"v"+(e.sourceNode.height/2+(e.targetNode.y-e.sourceNode.y-e.sourceNode.height)/2)+"H"+(e.targetNode.x-t.connectorWSelf)+"V"+(e.targetNode.y+e.targetNode.height/2)+"h"+t.connectorWSelf}}):t._e(),t._v(" "),e.sourceNode.id!=e.targetNode.id&&e.sourceNode.x+e.sourceNode.width>=e.targetNode.x&&e.targetNode.y+e.targetNode.height<e.sourceNode.y?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+t.connectorWSelf+"V"+(e.sourceNode.y-(e.sourceNode.y-e.targetNode.y-e.targetNode.height)/2)+"H"+(e.targetNode.x-t.connectorWSelf)+"V"+(e.targetNode.y+e.targetNode.height/2)+"H"+e.targetNode.x}}):t._e(),t._v(" "),e.sourceNode.id!=e.targetNode.id&&e.sourceNode.x+e.sourceNode.width>=e.targetNode.x&&e.sourceNode.y+e.sourceNode.height/2<=e.targetNode.y+e.targetNode.height/2&&(e.targetNode.y<=e.sourceNode.y+e.sourceNode.height&&e.targetNode.y>=e.sourceNode.y||e.sourceNode.y<=e.targetNode.y+e.targetNode.height&&e.sourceNode.y>=e.targetNode.y)?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+t.connectorWSelf+"V"+(e.sourceNode.y-e.targetNode.y<=0?e.sourceNode.y-t.connectorWSelf:e.targetNode.y-t.connectorWSelf)+"H"+(e.targetNode.x-t.connectorWSelf)+"V"+(e.targetNode.y+e.targetNode.height/2)+"H"+e.targetNode.x}}):t._e(),t._v(" "),e.sourceNode.id!=e.targetNode.id&&e.sourceNode.x+e.sourceNode.width>=e.targetNode.x&&e.sourceNode.y+e.sourceNode.height/2>e.targetNode.y+e.targetNode.height/2&&(e.targetNode.y<=e.sourceNode.y+e.sourceNode.height&&e.targetNode.y>=e.sourceNode.y||e.sourceNode.y<=e.targetNode.y+e.targetNode.height&&e.sourceNode.y>=e.targetNode.y)?o("path",{staticClass:"connectorLine",class:{defaultStrokeColor:!e.color,defaultStrokeW:!e.strokeW},attrs:{stroke:e.color,"stroke-width":e.strokeW,d:"M"+(e.sourceNode.x+e.sourceNode.width)+","+(e.sourceNode.y+e.sourceNode.height/2)+"h"+t.connectorWSelf+"V"+(e.sourceNode.y+e.sourceNode.height-e.targetNode.y-e.targetNode.height>=0?e.sourceNode.y+e.sourceNode.height+t.connectorWSelf:e.targetNode.y+e.targetNode.height+t.connectorWSelf)+"H"+(e.targetNode.x-t.connectorWSelf)+"V"+(e.targetNode.y+e.targetNode.height/2)+"H"+e.targetNode.x}}):t._e()]):t._e()})),t._v(" "),o("g",[o("line",{directives:[{name:"show",rawName:"v-show",value:t.connectingLine.isConnecting,expression:"connectingLine.isConnecting"}],attrs:{x1:t.connectingLine.x1,y1:t.connectingLine.y1,x2:t.connectingLine.x2,y2:t.connectingLine.y2,stroke:"#768699","stroke-width":"2"}})])],2),t._v(" "),o("line",{staticClass:"marker",class:{isMarkerShow:t.marker.isMarkerShow},attrs:{id:"xmarker",x1:"0",y1:t.marker.xmarkerY,x2:t.marker.xmarkerX,y2:t.marker.xmarkerY}}),t._v(" "),o("line",{staticClass:"marker",class:{isMarkerShow:t.marker.isMarkerShow},attrs:{id:"ymarker",x1:t.marker.ymarkerX,y1:"0",x2:t.marker.ymarkerX,y2:t.marker.ymarkerY}}),t._v(" "),o("rect",{directives:[{name:"show",rawName:"v-show",value:t.selectionBox.isShow,expression:"selectionBox.isShow"}],attrs:{x:t.selectionBox.x,y:t.selectionBox.y,width:t.selectionBox.width,height:t.selectionBox.height,"stroke-dasharray":"5,5","stroke-width":"1",stroke:"#222",fill:"rgba(170,210,232,0.5)"}})]),t._v(" "),o("v-topo-attr-panel",{directives:[{name:"show",rawName:"v-show",value:t.editable,expression:"editable"}],attrs:{"v-select-node-data":t.selectNodeData}})],1)],1),t._v(" "),t.shapebarMoveNode.isShow?o("div",{staticClass:"moveNode nodeMoveCss",style:{left:t.shapebarMoveNode.left+"px",top:t.shapebarMoveNode.top+"px"}},[o("div",{staticClass:"shapeIcon"},[o("img",{staticClass:"shapeIconImg",attrs:{src:t.shapebarMoveNode.icon}})]),t._v(" "),o("div",{staticClass:"shapeName"},[t._v(t._s(t.shapebarMoveNode.name))])]):t._e(),t._v(" "),o("el-dialog",{attrs:{visible:t.editShow,title:"新增"},on:{"update:visible":function(e){t.editShow=e}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.editLoading,expression:"editLoading"}],attrs:{"label-width":"80px","element-loading-text":"新增中"}},[o("el-form-item",{attrs:{label:"环境名称"}},[o("el-input",{attrs:{size:"medium"},model:{value:t.layout.name,callback:function(e){t.$set(t.layout,"name",e)},expression:"layout.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"环境描述"}},[o("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:t.layout.desc,callback:function(e){t.$set(t.layout,"desc",e)},expression:"layout.desc"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"Banner 图"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":t.upload,"show-file-list":!1,"before-upload":t.beforeAvatarUpload}},[t.layout.imageName?o("img",{staticClass:"avatar",attrs:{src:t.layout.imageName}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.handleOk}},[t._v("确定")]),t._v(" "),o("el-button",{attrs:{size:"medium"},on:{click:t.handleCancel}},[t._v("取消")])],1)],1)],1)],1)},n=[],i=(o("a481"),o("7f7f"),o("7514"),o("ac6a"),o("c5f6"),o("6b54"),o("0cef")),r=[{type:"Container",canBeContainedType:[],canLinkToType:["Network"]},{type:"Network",canBeContainedType:[],canLinkToType:["Container"]}],s=r,c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:{active:t.isTopoAttrShow},attrs:{id:"topoAttrWrap"}},[a("h3",{attrs:{id:"topoAttrHeader"}},[t._v("属性设置框")]),t._v(" "),"{}"===JSON.stringify(t.nodeData)?a("div",{staticClass:"noAttrTip"},[t._v("\n    未选择任何节点属性\n  ")]):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isContainer,expression:"isContainer"}]},[a("el-form",{ref:"containerForm",attrs:{model:t.image,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"镜像名称","fetch-suggestions":t.querySearchImageAsync},on:{select:t.handleImageSelect},model:{value:t.searchImageName,callback:function(e){t.searchImageName=e},expression:"searchImageName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"漏洞镜像"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:t.image.name,callback:function(e){t.$set(t.image,"name",e)},expression:"image.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"漏洞描述"}},[a("el-input",{attrs:{type:"textarea",size:"small",disabled:""},model:{value:t.image.desc,callback:function(e){t.$set(t.image,"desc",e)},expression:"image.desc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"是否开放"}},[a("el-switch",{model:{value:t.image.open,callback:function(e){t.$set(t.image,"open",e)},expression:"image.open"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"镜像端口"}},[a("label",[t._v(t._s(t.image.port))])]),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleImageOk}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.handleImageCancel}},[t._v("取消")])],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isNetwork,expression:"isNetwork"}]},[a("el-form",{ref:"networkForm",attrs:{model:t.network,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"网卡名称"}},[a("el-autocomplete",{attrs:{size:"small",placeholder:"网卡名称","fetch-suggestions":t.querySearchNetworkAsync},on:{select:t.handleNetworkSelect},model:{value:t.searchNetworkName,callback:function(e){t.searchNetworkName=e},expression:"searchNetworkName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"子网"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:t.network.subnet,callback:function(e){t.$set(t.network,"subnet",e)},expression:"network.subnet"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"网关"}},[a("el-input",{attrs:{size:"small",disabled:""},model:{value:t.network.gateway,callback:function(e){t.$set(t.network,"gateway",e)},expression:"network.gateway"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.handleNetworkOk}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.handleNetworkCancel}},[t._v("取消")])],1)],1)],1),t._v(" "),a("i",{staticClass:"topoAttrArrow",class:{pushIcon:!t.isTopoAttrShow,pullIcon:t.isTopoAttrShow},on:{click:function(e){t.isTopoAttrShow=!t.isTopoAttrShow}}},[t.isTopoAttrShow?a("img",{attrs:{src:o("d2ef")}}):a("img",{attrs:{src:o("6245")}})])])},d=[],l=o("3007"),h=o("ab10"),u={name:"vTopoAttrPanel",props:{vSelectNodeData:{type:Object,default:function(){return{}}}},data:function(){return{isTopoAttrShow:!1,isContainer:!1,isNetwork:!1,imageList:[],networkList:[],searchImageName:"",searchNetworkName:"",image:{id:"",vul_name:"",name:"",desc:"",port:"",open:!1,raw:{}},network:{id:"",name:"",subnet:"",gateway:"",raw:{}}}},computed:{nodeData:function(){this.isTopoAttrShow=!1,this.imageList=!1,this.isContainer=!1,this.isNetwork=!1;var t=JSON.parse(JSON.stringify(this.vSelectNodeData)),e=t["type"];return"Container"===e?(this.isContainer=!0,this.searchImageName="",this.image={id:"",vul_name:"",name:"",desc:"",port:"",open:!1,raw:{}},"{}"!==JSON.stringify(t.attrs)&&(this.searchImageName=t.attrs.name,this.image=t.attrs)):"Network"===e&&(this.isNetwork=!0,this.searchNetworkName="",this.network={id:"",name:"",subnet:"",gateway:"",raw:{}},"{}"!==JSON.stringify(t.attrs)&&(this.searchNetworkName=t.attrs.name,this.network=t.attrs)),t}},components:{},methods:{querySearchImageAsync:function(t,e){var o=this;this.imageList=[],null==t&&(t=""),Object(l["e"])(t).then((function(t){var a=t.data.results;null!==a&&a.forEach((function(t,e,a){o.imageList.push({value:t["image_name"],data:t})})),o.imageList.length>0&&e(o.imageList)}))},handleImageSelect:function(t){var e=t.data;this.searchImageName=t.value,this.image.id=e.image_id,this.image.vul_name=e.image_vul_name,this.image.name=e.image_name,this.image.desc=e.image_desc,this.image.port=e.image_port,this.image.raw=e},querySearchNetworkAsync:function(t,e){var o=this;this.networkList=[],null==t&&(t=""),Object(h["b"])(t,1).then((function(t){var a=t.data.results;null!==a&&a.forEach((function(t,e,a){o.networkList.push({value:t["net_work_name"],data:t})})),o.networkList.length>0&&e(o.networkList)}))},handleNetworkSelect:function(t){var e=t.data;this.searchNetworkName=t.value,this.network.id=e.net_work_id,this.network.name=e.net_work_name,this.network.gateway=e.net_work_gateway,this.network.subnet=e.net_work_subnet,this.network.raw=e},handleImageOk:function(){""===this.image.id?this.$message({type:"error",message:"请选择镜像"}):(this.vSelectNodeData.attrs=this.image,this.$message({type:"success",message:"设置成功"}),this.isTopoAttrShow=!1,this.imageList=[],this.isContainer=!1,this.isNetwork=!1,this.searchImageName="",this.image={id:"",name:"",desc:"",port:"",open:!1})},handleImageCancel:function(){this.isTopoAttrShow=!1},handleNetworkOk:function(){""===this.network.id?this.$message({type:"error",message:"请选择网卡"}):(this.vSelectNodeData.attrs=this.network,this.$message({type:"success",message:"设置成功"}),this.isTopoAttrShow=!1,this.isContainer=!1,this.isNetwork=!1,this.networkList=[],this.searchImageName="",this.network={id:"",name:"",subnet:"",gateway:"",raw:{}})},handleNetworkCancel:function(){this.isTopoAttrShow=!1}}},f=u,p=(o("3005"),o("2877")),g=Object(p["a"])(f,c,d,!1,null,"4baf6ef9",null),m=g.exports,v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"shapebarWrap"},[o("div",{staticClass:"shapebarHead"},[t._v("\n        环境类型\n    ")]),t._v(" "),o("div",{staticClass:"shapeNodeLstWrap"},[o("ul",{staticClass:"shapeNodeLst"},t._l(t.shapeNodeLstData,(function(e,a){return o("li",{key:a,staticClass:"shapeNode",attrs:{title:e.type},on:{mousedown:function(e){return e.stopPropagation(),e.preventDefault(),t.dragShapeNode(t.shapeNodeLstData,a,e)}}},[o("div",{staticClass:"shapeIcon"},[o("img",{staticClass:"shapeIconImg",attrs:{src:e.icon,alt:""}})]),t._v(" "),o("div",{staticClass:"shapeName"},[t._v(t._s(e.type))])])})),0)])])},N=[],y=[{type:"Container",icon:o("3ed2"),width:200,height:120,num:1,classType:"T1"},{type:"Network",icon:o("344b"),width:200,height:100,num:1,classType:"T1"}],A=y,w={name:"vShapebar",data:function(){return{shapeNodeLstData:[]}},components:{},methods:{dragShapeNode:function(t,e,o){this.$emit("click",t,e,o)},initToolbarNodes:function(){var t=A;!t instanceof Array&&(t=[]),this.shapeNodeLstData=t}},mounted:function(){this.initToolbarNodes()},created:function(){}},x=w,k=(o("5abf"),Object(p["a"])(x,v,N,!1,null,"7d9a9148",null)),S=k.exports,C=o("1157"),b=o.n(C),D={name:"index",props:{editable:{type:Boolean,default:!0},layoutId:{type:String,default:""}},data:function(){return{keyFormRules:{key:[{required:!0,message:"请输入key值",trigger:"blur"}],value:[{required:!0,message:"请输入value值",trigger:"blur"}]},connectorRules:s,selectNodeData:{},selectNodeIndex:0,topoId:"",svgAttr:{width:0,height:0,isHand:!1,viewX:0,viewY:0,minW:0,minH:0,isCrosshair:!1},activeNames:["1"],svgToolbar:[{name:"默认模式",className:"toolbar-default",isActive:!0},{name:"框选模式",className:"toolbar-rectangle_selection",isActive:!1}],shapebarMoveNode:{left:0,top:0,name:"",icon:"",isShow:!1},svgTopo:{isMoveover:!1},selectionBox:{x:0,y:0,width:0,height:0,isShow:!1},connectorWSelf:15,connectorW:15,containTop:30,containLeft:22,classchoose:!1,connectingLine:{x1:0,y1:0,x2:0,y2:0,isConnecting:!0,sourceNode:"",endNode:""},marker:{xmarkerY:0,xmarkerX:0,ymarkerX:0,ymarkerY:0,isMarkerShow:!1},gridData:[{x1:0,x2:100,y1:20,y2:20,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:1},{x1:0,x2:100,y1:40,y2:40,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:2},{x1:0,x2:100,y1:60,y2:60,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:3},{x1:0,x2:100,y1:80,y2:80,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:4},{x1:20,x2:20,y1:0,y2:100,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:5},{x1:40,x2:40,y1:0,y2:100,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:6},{x1:60,x2:60,y1:0,y2:100,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:7},{x1:80,x2:80,y1:0,y2:100,color:"#c0c0c0",strokeWidth:1,opacity:.3,id:8},{x1:100,x2:100,y1:0,y2:100,color:"#c0c0c0",strokeWidth:2,opacity:.6,id:9},{x1:0,x2:100,y1:100,y2:100,color:"#c0c0c0",strokeWidth:2,opacity:.6,id:10}],topoData:{nodes:[],connectors:[]},isShow:!0,editShow:!1,editLoading:!1,layout:{id:"",name:"",desc:"",imageName:""},newFile:new FormData}},computed:{},components:{vTopoAttrPanel:m,vShapebar:S},methods:{GenNonDuplicateID:function(t){return Number(Math.random().toString().substr(3,t)+Date.now()).toString(36)},canConnectorTo:function(t,e,o){var a=!1;return"Link"===o?this.connectorRules.forEach((function(o,n){o.type===t&&o.canLinkToType.forEach((function(t,o){t===e&&(a=!0)}))})):"Contain"===o&&this.connectorRules.forEach((function(o,n){o.type===t&&o.canBeContainedType.forEach((function(t,o){t===e&&(a=!0)}))})),a},dragShapeNode:function(t,e,o){var a=this,n=t[e],i=n.type,r=n.icon,s=b()("#topoId".concat(this.topoId)),c=s.find(".topoSvg").offset().left,d=s.find(".topoSvg").offset().top,l=s.find(".topoSvg").width(),h=s.find(".topoSvg").height(),u=!1;function f(t){return Number(Math.random().toString().substr(3,t)+Date.now()).toString(36)}document.onmousemove=function(t){var e=t.clientX,o=t.clientY,n=t.clientX-c+b()(document).scrollLeft()+a.svgAttr.viewX,s=t.clientY-d+b()(document).scrollTop()+a.svgAttr.viewY;if(u=!1,a.shapebarMoveNode.left=e+4+b()(document).scrollLeft(),a.shapebarMoveNode.top=o+4+b()(document).scrollTop(),a.shapebarMoveNode.name=i,a.shapebarMoveNode.icon=r,a.shapebarMoveNode.isShow=!0,a.marker.isMarkerShow=!1,e>=c&&e<=c+l&&o>=d-b()(document).scrollTop()&&o<=d+h-b()(document).scrollTop()){a.marker.isMarkerShow=!0,u=!0;var f=Math.floor(n/20),p=Math.floor(s/20);a.marker.xmarkerY=20*p,a.marker.ymarkerX=20*f}},document.onmouseup=function(t){if(document.onmousemove=null,document.onmouseup=null,u){var e=a.topoData,o=n.type,i=n.type,r=f(5),s=a.marker.ymarkerX,c=a.marker.xmarkerY,d={name:i,type:o,id:r,x:s,y:c,icon:n.icon,width:n.width,height:n.height,initW:n.width,initH:n.height,classType:n.classType,isLeftConnectShow:!1,isRightConnectShow:!1,containNodes:[],attrs:{}};a.marker.isMarkerShow=!1,a.topoData.nodes.push(d);for(var l=e.nodes.length-1;l>=0;l--){var h=e.nodes[l];if(h.x<=s&&s<=h.x+h.width&&c>=h.y&&h.y+h.height>=c&&h.id!==r){var p=a.canConnectorTo(n.type,h.type,"Contain");if(p){var g=a.GenNonDuplicateID(3),m={id:g,type:"Contain",sourceNode:{id:r},targetNode:{id:h.id},isSelect:!1};e.connectors.push(m),h.containNodes.push(r),a.refreshRowAndOuterNode(d),a.refreshConnectorsData();break}}}}a.shapebarMoveNode.left=0,a.shapebarMoveNode.top=0,a.shapebarMoveNode.name="",a.shapebarMoveNode.icon="",a.shapebarMoveNode.isShow=!1}},mousedownTopoSvg:function(t){var e=this,o=t.clientX,a=t.clientY,n=this.svgAttr.viewX,i=this.svgAttr.viewY,r=this.svgAttr.width,s=this.svgAttr.height,c=this.svgAttr.minW,d=this.svgAttr.minH,l=0,h=0;if(this.cancelAllNodesSelect(),this.cancelAllLinksSelect(),this.svgToolbar[1].isActive){var u=b()("#topoId".concat(this.topoId));l=t.clientX-u.find(".topoSvg").offset().left+b()(document).scrollLeft()+this.svgAttr.viewX,h=t.clientY-u.find(".topoSvg").offset().top+4+b()(document).scrollTop()+this.svgAttr.viewY,this.selectionBox.isShow=!0,this.selectionBox.x=l,this.selectionBox.y=h}document.onmousemove=function(t){var u=t.clientX-o,f=t.clientY-a,p=r-u,g=s-f;if(e.svgToolbar[1].isActive){var m=Math.abs(u),v=Math.abs(f);return e.svgAttr.isCrosshair=!0,e.selectionBox.x=u<=0?l+u:l,e.selectionBox.y=f<=0?h+f:h,e.selectionBox.width=m,e.selectionBox.height=v,!1}e.svgAttr.isHand=!0,e.svgAttr.viewX=n<=u?0:n-u,e.svgAttr.viewY=i<=f?0:i-f,e.svgAttr.width=p<c?c:p,e.svgAttr.height=g<d?d:g,e.marker.xmarkerX=e.svgAttr.width,e.marker.ymarkerY=e.svgAttr.height},document.onmouseup=function(t){if(document.onmousemove=null,document.onmouseup=null,e.svgAttr.isHand=!1,e.svgAttr.isCrosshair=!1,e.svgToolbar[1].isActive){var o=e.selectionBox,a=o.width,n=o.height,i=o.x,r=o.y;e.topoData.nodes.forEach((function(t,e){i<=t.x&&r<=t.y&&t.x+t.width<=i+a&&t.y+t.height<=r+n&&(t.isSelect=!0)})),e.selectionBox.isShow=!1,e.selectionBox.x=0,e.selectionBox.y=0,e.selectionBox.width=0,e.selectionBox.height=0}}},dragSvgNode:function(t,e){var o=this;if(!this.editable)return!1;var a=e.clientX+b()(document).scrollLeft(),n=e.clientY+b()(document).scrollTop(),i=this.topoData.nodes[t],r=i.x,s=i.y,c=(i.id,i.width,i.height,[]);this.marker.isMarkerShow=!0,this.topoData.nodes.splice(t,1),this.topoData.nodes.push(i),this.putInnerNodeLast(i),this.cancelAllNodesSelect(),this.cancelAllLinksSelect(),i.isSelect=!0,this.storeCurnodeStartPosition(i,c),this.topoData.nodes.forEach((function(t,e){t.id===i.id&&(o.selectNodeData=t)})),document.onmousemove=function(t){var e=t.clientX-a+b()(document).scrollLeft(),i=t.clientY-n+b()(document).scrollTop(),d=r+e,l=s+i,h=Math.floor(d/20),u=Math.floor(l/20);h<=0&&(h=0),u<=0&&(u=0),d<=0&&(d=0,e=-r),l<=0&&(l=0,i=-s),o.marker.isMarkerShow=!0,o.marker.xmarkerY=20*u,o.marker.ymarkerX=20*h,o.moveContianNode(e,i,c),o.refreshConnectorsData()},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,o.marker.isMarkerShow=!1;var e=o.marker.ymarkerX,d=o.marker.xmarkerY,l=e-r,h=d-s,u=t.clientX-a,f=t.clientY-n;o.moveContianNode(l,h,c),o.drawContainLayout(i,e,d,!0,c,u,f,s),o.refreshConnectorsData()}},drawContainLayout:function(t,e,o,a,n,i,r,s){var c=this,d=this.topoData,l=t.id,h=t.width,u=t.height,f="",p={},g=[e,o],m=[e+h,o],v=[e+h,o+u],N=[e,o+u];d.connectors.forEach((function(t,e){"Contain"===t.type&&t.sourceNode.id===l&&(f=t.targetNode.id)})),f&&d.nodes.forEach((function(t,e){t.id===f&&(p=t)}));var y=s+r;if(p&&Math.abs(i)<=this.containLeft&&y<p.y+p.height&&y>p.y-t.height)return this.refreshRowAndOuterNode(p),!1;this.deleteCurNodeContainConnector(t);for(var A=!1,w={},x=d.nodes.length-1;x>=0;x--){var k=d.nodes[x];if(A=!1,t.id!==k.id){var S=k.x,C=k.x+k.width,b=k.y,D=k.y+k.height,L=this.canConnectorTo(t.type,k.type,"Contain");if(g[0]<=C&&g[0]>=S&&g[1]<=D&&g[1]>=b&&(A=!0),m[0]<=C&&m[0]>=S&&m[1]<=D&&m[1]>=b&&(A=!0),N[0]<=C&&N[0]>=S&&N[1]<=D&&N[1]>=b&&(A=!0),v[0]<=C&&v[0]>=S&&v[1]<=D&&v[1]>=b&&(A=!0),A&&L){w=k;break}}}if(A){var _=this.GenNonDuplicateID(3),W={id:_,type:"Contain",sourceNode:{id:t.id},targetNode:{id:w.id},isSelect:!1};d.connectors.push(W),d.nodes.forEach((function(e,o){e.id===w.id&&e.containNodes.push(t.id)})),this.refreshRowAndOuterNode(t)}A&&n.forEach((function(e,o){if(e.id===t.id){var a=t.x-e.x,i=t.y-e.y;c.moveContianNode(a,i,n)}})),f&&f!==w.id&&this.refreshRowAndOuterNode(p)},computedIsContain:function(t){},storeCurnodeStartPosition:function(t,e){var o=this,a=t.containNodes;e.push({id:t.id,x:t.x,y:t.y}),a.length&&a.forEach((function(t,a){o.topoData.nodes.forEach((function(a,n){a.id===t&&o.storeCurnodeStartPosition(a,e)}))}))},moveContianNode:function(t,e,o){var a=this;o.forEach((function(o,n){var i=o.id;a.topoData.nodes.forEach((function(a,n){a.id===i&&(a.x=o.x+t,a.y=o.y+e)}))}))},putInnerNodeLast:function(t){var e=this,o=t.id;this.topoData.connectors.forEach((function(t,a){if("Contain"===t.type&&t.targetNode.id===o){var n=t.sourceNode.id;e.topoData.nodes.forEach((function(t,o){if(t.id===n){var a=t;e.topoData.nodes.splice(o,1),e.topoData.nodes.push(a),e.putInnerNodeLast(a)}}))}}))},deleteCurNodeContainConnector:function(t){var e=this,o=t.id;this.topoData.connectors.forEach((function(t,a){if("Contain"===t.type&&t.sourceNode.id===o){var n=t.targetNode.id;e.topoData.connectors.splice(a,1),e.topoData.nodes.forEach((function(t,e){t.id===n&&t.containNodes.length&&t.containNodes.forEach((function(e,a){var n=t;e===o&&n.containNodes.splice(a,1)}))}))}}))},refreshOuterNodeWidth:function(t){var e=this;this.topoData.connectors.forEach((function(o,a){if(o.sourceNode.id===t.id&&"Contain"===o.type){var n=o.targetNode.id;e.topoData.nodes.forEach((function(o,a){o.id===n&&(o.width=2*e.containLeft+t.width,o.height=10+t.height+e.containTop,e.refreshOuterNodeWidth(o))}))}}))},refreshRowAndOuterNode:function(t){var e=this;if(t.containNodes.length>0){var o=0,a=0;t.containNodes.forEach((function(t,n){var i=t;e.topoData.nodes.forEach((function(t,e){t.id===i&&(o+=t.width,t.height>a&&(a=t.height))}))})),o+=(t.containNodes.length+1)*this.containLeft,t.width=o,t.height=a+10+this.containTop}else t.width=t.initW,t.height=t.initH;this.topoData.connectors.forEach((function(o,a){var n="";o.sourceNode.id===t.id&&"Contain"===o.type&&(n=o.targetNode.id,e.topoData.nodes.forEach((function(t,o){t.id===n&&e.refreshRowAndOuterNode(t)})))})),this.refreshContainNodesPosition(t)},refreshContainNodesPosition:function(t){var e=this;t.containNodes.forEach((function(o,a){var n,i,r=o;if(e.topoData.nodes.forEach((function(t,e){t.id===r&&(n=t)})),0===a)e.refreshRowNodesPosition(t,n,null);else{var s=a-1,c=t.containNodes[s];e.topoData.nodes.forEach((function(t,e){t.id===c&&(i=t)})),e.refreshRowNodesPosition(t,n,i)}}))},refreshRowNodesPosition:function(t,e,o){e.x=null!=o?o.x+o.width+this.containLeft:t.x+this.containLeft,e.y=t.y+this.containTop,this.refreshContainNodesPosition(e)},refreshConnectorsData:function(){var t=this;this.topoData.connectors.forEach((function(e,o){t.topoData.nodes.forEach((function(t,o){e.sourceNode.id===t.id&&(e.sourceNode.width=t.width,e.sourceNode.height=t.height,e.sourceNode.x=t.x,e.sourceNode.y=t.y),e.targetNode.id===t.id&&(e.targetNode.width=t.width,e.targetNode.height=t.height,e.targetNode.x=t.x,e.targetNode.y=t.y)}))}))},drawConnectLine:function(t,e){var o=this;if(!this.editable)return!1;var a=this.connectingLine,n=this.topoData.nodes[t],i=n.width,r=n.height,s=n.x,c=n.y,d=e.clientX,l=e.clientY,h=b()("#topoId".concat(this.topoId)),u=e.clientX-h.find(".topoSvg").offset().left-2+b()(document).scrollLeft()+this.svgAttr.viewX,f=e.clientY-h.find(".topoSvg").offset().top+4+b()(document).scrollTop()+this.svgAttr.viewY;a.isConnecting=!0,a.x1=u,a.y1=f,a.x2=u,a.y2=f,a.sourceNode=n.id,document.onmousemove=function(t){var e=t.clientX-d,o=t.clientY-l,i=u+e,r=f+o;n.isRightConnectShow=!0,a.x2=i,a.y2=r},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null;var t=!1,e=o.topoData.connectors,d=i,l=r,h=0,u=0,f=0,p=0,g="",m="";if(a.endNode){if(e.forEach((function(e,o){e.sourceNode.id===n.id&&e.targetNode.id===a.endNode&&"Line"===e.type&&(t=!0)})),!t){m="Line",o.topoData.nodes.forEach((function(t,e){t.id===a.endNode&&(h=t.width,u=t.height,f=t.x,p=t.y,g=t.type)}));var v=o.canConnectorTo(n.type,g,"Link");if(v){var N=o.GenNonDuplicateID(3),y={id:N,type:m,strokeW:3,color:"#768699",targetNode:{x:f,y:p,id:a.endNode,width:h,height:u},sourceNode:{x:s,y:c,id:n.id,width:d,height:l}};n.isRightConnectShow=!0,o.topoData.nodes.forEach((function(t,e){t.id===a.endNode&&(t.isLeftConnectShow=!0)})),e.push(y)}else o.$message({showClose:!0,message:n.type+"类型 不能连接 "+g+"类型",type:"error"}),n.isRightConnectShow=!1,e.forEach((function(t,e){o.topoData.nodes.forEach((function(e,o){e.id===t.sourceNode.id&&"Line"===t.type&&(e.isRightConnectShow=!0)}))}))}}else n.isRightConnectShow=!1,e.forEach((function(t,e){o.topoData.nodes.forEach((function(e,o){e.id===t.sourceNode.id&&"Line"===t.type&&(e.isRightConnectShow=!0)}))}));a.x1=0,a.y1=0,a.x2=0,a.y2=0,a.isConnecting=!1,a.sourceNode="",a.endNode=""}},mouseoverNode:function(t,e){this.marker.xmarkerY=this.topoData.nodes[t].y,this.marker.ymarkerX=this.topoData.nodes[t].x,this.getConnectLine(t)},getConnectLine:function(t){this.connectingLine.endNode=this.topoData.nodes[t].id},mouseoutLeftConnector:function(t){this.connectingLine.endNode=""},selectConnectorLine:function(t){if(!this.editable)return!1;var e=this.topoData.connectors,o=(this.topoData.nodes,this.topoData.connectors[t]),a=e.length-1;e.splice(t,1),e.push(o),this.cancelAllNodesSelect(),this.cancelAllLinksSelect(),o.isSelect=!0,this.$set(e,a,o),this.selectNodeData=o},cancelAllNodesSelect:function(){var t=this;this.topoData.nodes.forEach((function(e,o){e.isSelect=!1,t.$set(t.topoData.nodes,o,e)})),this.selectNodeData={}},cancelAllLinksSelect:function(){var t=this;this.topoData.connectors.forEach((function(e,o){e.isSelect=!1,t.$set(t.topoData.connectors,o,e)})),this.selectNodeData={}},deleteNodeAndConnector:function(){var t=this;document.onkeydown=function(e){var o=e.composedPath(),a=e.which;if(!(o.length>10)&&(46===a||8===a)){for(var n=function(e){var o=t.topoData.nodes[e];if(o.isSelect){t.deleteSelectNodeLink(o.id);var a="";t.topoData.connectors.forEach((function(t,e){t.sourceNode.id===o.id&&(a=t.targetNode.id)})),t.deleteCurNodeContainConnector(o),a&&t.topoData.nodes.forEach((function(e,o){e.id===a&&t.refreshRowAndOuterNode(e)})),t.topoData.nodes.splice(e,1),t.deleteCurnodeAndChildnodes(o),t.refreshNodeArrows(),e--,t.topoData.nodes.length>0?t.selectNodeIndex=t.selectNodeData={}:(t.selectNodeIndex=null,t.selectNodeData={},t.isTopoAttrShow=!1)}i=e},i=0;i<t.topoData.nodes.length;i++)n(i);t.topoData.connectors.forEach((function(e,o){e.isSelect&&(t.topoData.connectors.splice(o,1),t.refreshNodeArrows())})),t.refreshConnectorsData()}}},deleteSelectNodeLink:function(t){for(var e=this.topoData.connectors,o=e.length,a=0;a<o;a++){var n=e[a];"Line"!==n.type||n.sourceNode.id!==t&&n.targetNode.id!==t||(this.topoData.connectors.splice(a,1),a--,o--)}},deleteCurnodeAndChildnodes:function(t){var e=this;this.deleteCurNodeContainConnector(t),t.containNodes.length&&t.containNodes.forEach((function(t,o){var a=t;e.topoData.nodes.forEach((function(t,o){if(t.id===a){var n=t;e.topoData.nodes.splice(o,1),e.deleteSelectNodeLink(a),e.deleteCurnodeAndChildnodes(n)}}))}))},refreshNodeArrows:function(){var t=this;this.topoData.nodes.forEach((function(t,e){t.isLeftConnectShow=!1,t.isRightConnectShow=!1})),this.topoData.connectors.forEach((function(e,o){var a=e.sourceNode.id,n=e.targetNode.id;"Line"===e.type&&t.topoData.nodes.forEach((function(t,e){t.id===n&&(t.isLeftConnectShow=!0),t.id===a&&(t.isRightConnectShow=!0)}))}))},selectToolbar:function(t){this.svgToolbar.forEach((function(t,e){t.isActive=!1})),this.svgToolbar[t].isActive=!0},saveTopoJson:function(){this.editShow=!0},handleOk:function(){var t=this;""!==this.layout.name&&null!==this.layout.name?""!==this.layout.imageName&&null!==this.layout.imageName&&"/images/"!==this.layout.imageName?null!==this.layout.id&&void 0!==this.layout.id&&""!==this.layout.id?this.$confirm("确认修改，修改会影响用户得分","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.handleLayoutCreate()})).catch():this.handleLayoutCreate():this.$message({message:"请上传 banner 图",type:"error"}):this.$message({message:"请输入环境名称",type:"error"})},handleLayoutCreate:function(){var t=this,e=this.layout.imageName.replace("/images/",""),o=new FormData;o.set("id",this.layout.id),o.set("data",JSON.stringify(this.topoData)),o.set("name",this.layout.name),o.set("desc",this.layout.desc),o.set("img",e),Object(i["a"])(o).then((function(e){var o=e.data;200===o.status?(null!==t.layout.id&&void 0!==t.layout.id&&""!==t.layout.id?t.$message({message:"修改成功",type:"success"}):t.$message({message:"创建成功",type:"success"}),t.goBack()):t.$message({message:o.msg,type:"error"}),t.editShow=!1}))},handleCancel:function(){this.editShow=!1},beforeAvatarUpload:function(t){if(!t)return!1;this.newFile.set("img",t)},upload:function(){var t=this,e=this.newFile;Object(i["e"])(e).then((function(e){var o=e.data;o.data&&200===o.status?(t.$message({message:"上传成功",type:"success"}),t.layout.imageName="/images/"+o.data):t.$message({message:o.msg,type:"error"})})).catch((function(e){t.$message({message:"服务器内部错误",type:"error"})}))},goBack:function(){this.$router.push({path:"/layout/manager"})},initTopoWH:function(){var t=this;this.$nextTick((function(){var e="#topoId".concat(t.topoId),o=b()(e).width(),a=b()(e).height();t.marker.xmarkerX=o,t.marker.ymarkerY=a,t.svgAttr.width=o,t.svgAttr.height=a,t.svgAttr.minW=o,t.svgAttr.minH=a}))}},mounted:function(){null!==this.$route.query.layoutData&&void 0!==this.$route.query.layoutData&&this.$route.query.layoutData.layout_id?(this.topoData=JSON.parse(this.$route.query.layoutData.raw_content),this.layout.id=this.$route.query.layoutData.layout_id,this.layout.name=this.$route.query.layoutData.layout_name,this.layout.desc=this.$route.query.layoutData.layout_desc,this.layout.imageName=this.$route.query.layoutData.image_name):(this.layout={id:"",name:"",desc:"",imageName:""},this.topoData={nodes:[],connectors:[]}),this.deleteNodeAndConnector(),this.topoId=this.GenNonDuplicateID(5),this.initTopoWH()}},L=D,_=(o("268a8"),o("16a8"),Object(p["a"])(L,a,n,!1,null,"7c6a5bfe",null));e["default"]=_.exports},"16a8":function(t,e,o){"use strict";o("f409")},"268a8":function(t,e,o){"use strict";o("7e06")},3005:function(t,e,o){"use strict";o("3753")},"344b":function(t,e){t.exports="data:image/png;base64,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"},3753:function(t,e,o){},"3ed2":function(t,e){t.exports="data:image/png;base64,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"},"5abf":function(t,e,o){"use strict";o("b1b9")},"5dbc":function(t,e,o){var a=o("d3f4"),n=o("8b97").set;t.exports=function(t,e,o){var i,r=e.constructor;return r!==o&&"function"==typeof r&&(i=r.prototype)!==o.prototype&&a(i)&&n&&n(t,i),t}},6245:function(t,e,o){t.exports=o.p+"static/img/push.73836d72.svg"},7514:function(t,e,o){"use strict";var a=o("5ca1"),n=o("0a49")(5),i="find",r=!0;i in[]&&Array(1)[i]((function(){r=!1})),a(a.P+a.F*r,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o("9c6c")(i)},"7e06":function(t,e,o){},"8b97":function(t,e,o){var a=o("d3f4"),n=o("cb7c"),i=function(t,e){if(n(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=o("9b43")(Function.call,o("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,o){return i(t,o),e?t.__proto__=o:a(t,o),t}}({},!1):void 0),check:i}},9093:function(t,e,o){var a=o("ce10"),n=o("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,n)}},a481:function(t,e,o){"use strict";var a=o("cb7c"),n=o("4bf8"),i=o("9def"),r=o("4588"),s=o("0390"),c=o("5f1b"),d=Math.max,l=Math.min,h=Math.floor,u=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(t){return void 0===t?t:String(t)};o("214f")("replace",2,(function(t,e,o,g){return[function(a,n){var i=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,i,n):o.call(String(i),a,n)},function(t,e){var n=g(o,t,this,e);if(n.done)return n.value;var h=a(t),u=String(this),f="function"===typeof e;f||(e=String(e));var v=h.global;if(v){var N=h.unicode;h.lastIndex=0}var y=[];while(1){var A=c(h,u);if(null===A)break;if(y.push(A),!v)break;var w=String(A[0]);""===w&&(h.lastIndex=s(u,i(h.lastIndex),N))}for(var x="",k=0,S=0;S<y.length;S++){A=y[S];for(var C=String(A[0]),b=d(l(r(A.index),u.length),0),D=[],L=1;L<A.length;L++)D.push(p(A[L]));var _=A.groups;if(f){var W=[C].concat(D,b,u);void 0!==_&&W.push(_);var T=String(e.apply(void 0,W))}else T=m(C,u,b,D,_,e);b>=k&&(x+=u.slice(k,b)+T,k=b+C.length)}return x+u.slice(k)}];function m(t,e,a,i,r,s){var c=a+t.length,d=i.length,l=f;return void 0!==r&&(r=n(r),l=u),o.call(s,l,(function(o,n){var s;switch(n.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,a);case"'":return e.slice(c);case"<":s=r[n.slice(1,-1)];break;default:var l=+n;if(0===l)return o;if(l>d){var u=h(l/10);return 0===u?o:u<=d?void 0===i[u-1]?n.charAt(1):i[u-1]+n.charAt(1):o}s=i[l-1]}return void 0===s?"":s}))}}))},aa77:function(t,e,o){var a=o("5ca1"),n=o("be13"),i=o("79e5"),r=o("fdef"),s="["+r+"]",c="​",d=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),h=function(t,e,o){var n={},s=i((function(){return!!r[t]()||c[t]()!=c})),d=n[t]=s?e(u):r[t];o&&(n[o]=d),a(a.P+a.F*s,"String",n)},u=h.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(d,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},ab10:function(t,e,o){"use strict";o.d(e,"b",(function(){return n})),o.d(e,"a",(function(){return i})),o.d(e,"c",(function(){return r}));var a=o("b775");function n(t,e){return void 0===t&&(t=""),void 0===e&&(e=1),Object(a["a"])({url:"/network/?query="+t+"&page="+e,method:"get"})}function i(t){return Object(a["a"])({url:"/network/",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/network/"+t+"/",method:"DELETE"})}},b1b9:function(t,e,o){},c5f6:function(t,e,o){"use strict";var a=o("7726"),n=o("69a8"),i=o("2d95"),r=o("5dbc"),s=o("6a99"),c=o("79e5"),d=o("9093").f,l=o("11e9").f,h=o("86cc").f,u=o("aa77").trim,f="Number",p=a[f],g=p,m=p.prototype,v=i(o("2aeb")(m))==f,N="trim"in String.prototype,y=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=N?e.trim():u(e,3);var o,a,n,i=e.charCodeAt(0);if(43===i||45===i){if(o=e.charCodeAt(2),88===o||120===o)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+e}for(var r,c=e.slice(2),d=0,l=c.length;d<l;d++)if(r=c.charCodeAt(d),r<48||r>n)return NaN;return parseInt(c,a)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,o=this;return o instanceof p&&(v?c((function(){m.valueOf.call(o)})):i(o)!=f)?r(new g(y(e)),o,p):y(e)};for(var A,w=o("9e1e")?d(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;w.length>x;x++)n(g,A=w[x])&&!n(p,A)&&h(p,A,l(g,A));p.prototype=m,m.constructor=p,o("2aba")(a,f,p)}},cd1c:function(t,e,o){var a=o("e853");t.exports=function(t,e){return new(a(t))(e)}},d2ef:function(t,e,o){t.exports=o.p+"static/img/pull.d7698110.svg"},e853:function(t,e,o){var a=o("d3f4"),n=o("1169"),i=o("2b4c")("species");t.exports=function(t){var e;return n(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!n(e.prototype)||(e=void 0),a(e)&&(e=e[i],null===e&&(e=void 0))),void 0===e?Array:e}},f409:function(t,e,o){},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-bbbd74a0.b2341c5a.js.map